---
title: IServiceçš„é“¾å¼è°ƒç”¨
date: 2026-1-29
---

MyBatis-Plusï¼ˆMPï¼‰ä¸­çš„ **`IService` çš„ Lambda é“¾å¼è°ƒç”¨** æ˜¯å…¶ Service å±‚æœ€ä¼˜é›…ã€é«˜æ•ˆçš„ç¼–ç¨‹æ–¹å¼ä¹‹ä¸€ã€‚å®ƒç»“åˆäº† **Lambda è¡¨è¾¾å¼ï¼ˆç±»å‹å®‰å…¨ï¼‰ + é“¾å¼è¯­æ³•ï¼ˆæµç•… APIï¼‰ + å†…ç½® CRUD é€»è¾‘**ï¼Œè®©ä½ åœ¨ Service å±‚å‡ ä¹ä¸ç”¨å†™é‡å¤ä»£ç ã€‚

ä¸‹é¢ä» **åŸç†ã€API åˆ†ç±»ã€è¯¦ç»†ç”¨æ³•ã€ç¤ºä¾‹ã€æ³¨æ„äº‹é¡¹** ç­‰æ–¹é¢å…¨é¢è®²è§£ã€‚

------

## ä¸€ã€ä»€ä¹ˆæ˜¯ Lambda é“¾å¼è°ƒç”¨ï¼Ÿ

MP åœ¨ `IService` ä¸­æä¾›äº†ä¸¤ä¸ªæ ¸å¿ƒé“¾å¼å…¥å£ï¼š

| é“¾å¼æ„å»ºå™¨ | ç”¨é€”                                              |
| ---------- | ------------------------------------------------- |
| `query()`  | æ„å»º **æŸ¥è¯¢æ¡ä»¶**ï¼ˆè¿”å› `QueryChainWrapper<T>`ï¼‰  |
| `update()` | æ„å»º **æ›´æ–°æ¡ä»¶**ï¼ˆè¿”å› `UpdateChainWrapper<T>`ï¼‰ |

å®ƒä»¬åº•å±‚ä»åŸºäº `LambdaQueryWrapper` / `LambdaUpdateWrapper`ï¼Œä½†å°è£…æˆæ›´æµç•…çš„é“¾å¼ APIã€‚

> âœ… ç‰¹ç‚¹ï¼š
>
> - **æ–¹æ³•é“¾å¼è°ƒç”¨**ï¼š`.eq().like().list()`
> - **Lambda å­—æ®µå¼•ç”¨**ï¼š`User::getName`ï¼ˆé¿å…å­—ç¬¦ä¸²ç¡¬ç¼–ç ï¼‰
> - **è‡ªåŠ¨æ‰§è¡Œ**ï¼šä»¥ `.one()` / `.list()` / `.update()` ç»“å°¾å³æ‰§è¡Œ

------

## äºŒã€QueryChainï¼ˆæŸ¥è¯¢é“¾ï¼‰

### ğŸ”§ 1. å…¥å£æ–¹æ³•

```java
QueryChainWrapper<T> query();
```

### ğŸ”§ 2. å¸¸ç”¨é“¾å¼æ–¹æ³•ï¼ˆæ¡ä»¶ï¼‰

| æ–¹æ³•                              | è¯´æ˜        | ç¤ºä¾‹                                        |
| --------------------------------- | ----------- | ------------------------------------------- |
| `eq(Fn<S, R> column, Object val)` | ç­‰äº        | `.eq(User::getAge, 18)`                     |
| `ne(...)`                         | ä¸ç­‰äº      | `.ne(User::getStatus, 0)`                   |
| `gt/lt/ge/le`                     | å¤§äº/å°äºç­‰ | `.ge(User::getScore, 90)`                   |
| `like/likeLeft/likeRight`         | æ¨¡ç³ŠåŒ¹é…    | `.likeRight(User::getName, "å¼ ")`           |
| `isNull/isNotNull`                | ç©ºå€¼åˆ¤æ–­    | `.isNotNull(User::getEmail)`                |
| `in/notIn`                        | IN æŸ¥è¯¢     | `.in(User::getId, Arrays.asList(1,2,3))`    |
| `between`                         | èŒƒå›´        | `.between(User::getCreateTime, start, end)` |
| `orderByAsc/Desc`                 | æ’åº        | `.orderByDesc(User::getId)`                 |
| `groupBy`                         | åˆ†ç»„        | `.groupBy(User::getDeptId)`                 |
| `having`                          | HAVING æ¡ä»¶ | `.having("COUNT(*) > {0}", 5)`              |

> ğŸ’¡ æ‰€æœ‰å­—æ®µå‚æ•°ä½¿ç”¨ **æ–¹æ³•å¼•ç”¨**ï¼š`Entity::getField`ï¼ˆè¦æ±‚æœ‰ getterï¼‰

------

### ğŸ”§ 3. ç»ˆæ­¢æ–¹æ³•ï¼ˆè§¦å‘æ‰§è¡Œï¼‰

| æ–¹æ³•                        | è¿”å›å€¼    | è¯´æ˜                            |
| --------------------------- | --------- | ------------------------------- |
| `one()`                     | `T`       | è¿”å›å•ä¸ªå¯¹è±¡ï¼ˆæ— ç»“æœè¿”å› nullï¼‰ |
| `one(RowBounds rowBounds)`  | `T`       | åˆ†é¡µå–ä¸€æ¡                      |
| `list()`                    | `List<T>` | è¿”å›åˆ—è¡¨                        |
| `list(RowBounds rowBounds)` | `List<T>` | åˆ†é¡µåˆ—è¡¨                        |
| `count()`                   | `Long`    | è¿”å›è®°å½•æ•°                      |
| `exists()`                  | `boolean` | æ˜¯å¦å­˜åœ¨æ»¡è¶³æ¡ä»¶çš„è®°å½•          |

------

### âœ… 4. æŸ¥è¯¢é“¾ç¤ºä¾‹

#### ï¼ˆ1ï¼‰åŸºæœ¬æŸ¥è¯¢

```java
List<User> users = userService.query()
    .likeRight(User::getName, "å¼ ")
    .ge(User::getAge, 18)
    .orderByDesc(User::getCreateTime)
    .list();
```

#### ï¼ˆ2ï¼‰æŸ¥å•æ¡

```java
User user = userService.query()
    .eq(User::getEmail, "zhang@example.com")
    .one(); // è‡ªåŠ¨ LIMIT 1
```

#### ï¼ˆ3ï¼‰æ˜¯å¦å­˜åœ¨

```java
boolean exists = userService.query()
    .eq(User::getPhone, "13800138000")
    .exists();
```

#### ï¼ˆ4ï¼‰èšåˆç»Ÿè®¡

```java
Long count = userService.query()
    .eq(User::getStatus, 1)
    .count();
```

> âš ï¸ æ³¨æ„ï¼š`count()` ä¸æ”¯æŒ `SELECT COUNT(x)` ä¸­çš„å­—æ®µæŒ‡å®šï¼Œå§‹ç»ˆæ˜¯ `COUNT(1)`ã€‚

------

## ä¸‰ã€UpdateChainï¼ˆæ›´æ–°é“¾ï¼‰

### ğŸ”§ 1. å…¥å£æ–¹æ³•

```java
UpdateChainWrapper<T> update();
```

### ğŸ”§ 2. æ ¸å¿ƒæ–¹æ³•

| æ–¹æ³•                                                  | è¯´æ˜                        |
| ----------------------------------------------------- | --------------------------- |
| `set(Fn<S, R> column, Object val)`                    | è®¾ç½®å­—æ®µå€¼                  |
| `set(boolean condition, Fn<S, R> column, Object val)` | æ¡ä»¶è®¾ç½®                    |
| `eq/ne/gt/like...`                                    | WHERE æ¡ä»¶ï¼ˆåŒ QueryChainï¼‰ |
| `update()`                                            | æ‰§è¡Œæ›´æ–°ï¼Œè¿”å› `boolean`    |

------

### âœ… 3. æ›´æ–°é“¾ç¤ºä¾‹

#### ï¼ˆ1ï¼‰ç®€å•æ›´æ–°

```java
boolean updated = userService.update()
    .set(User::getStatus, 0)
    .set(User::getUpdateTime, LocalDateTime.now())
    .eq(User::getAge, 16)
    .update(); // è¿”å›æ˜¯å¦æˆåŠŸ
```

ç”Ÿæˆ SQLï¼š

```sql
UPDATE user 
SET status = 0, update_time = '2026-01-29 19:00:00'
WHERE age = 16;
```

#### ï¼ˆ2ï¼‰æ¡ä»¶æ›´æ–°ï¼ˆåŠ¨æ€ï¼‰

```java
String newName = "æå››";
Integer newAge = null;

userService.update()
    .set(User::getName, newName)
    .set(newAge != null, User::getAge, newAge) // ä»…å½“ newAge != null æ—¶è®¾ç½®
    .eq(User::getId, 1001)
    .update();
```

#### ï¼ˆ3ï¼‰æ‰¹é‡ç¦ç”¨

```java
userService.update()
    .set(User::getStatus, 0)
    .lt(User::getAge, 18)
    .update();
```

------

## å››ã€é«˜çº§æŠ€å·§

### âœ… 1. é“¾å¼ + åˆ†é¡µ

è™½ç„¶é“¾å¼æœ¬èº«ä¸ç›´æ¥æ”¯æŒ `IPage`ï¼Œä½†å¯ç»“åˆ `page()` æ–¹æ³•ï¼š

```java
IPage<User> page = new Page<>(1, 10);
IPage<User> result = userService.page(page, 
    new LambdaQueryWrapper<User>()
        .eq(User::getStatus, 1)
);
```

> ğŸ”¸ é“¾å¼æŸ¥è¯¢ç›®å‰**ä¸èƒ½ç›´æ¥è¿”å› IPage**ï¼Œéœ€ç”¨ä¼ ç»Ÿ `page(Page, Wrapper)`ã€‚

### âœ… 2. å­—æ®µé€‰æ‹©ï¼ˆé¿å…æŸ¥å…¨è¡¨ï¼‰

é“¾å¼æŸ¥è¯¢**ä¸æ”¯æŒ `select()` æŒ‡å®šå­—æ®µ**ï¼
å¦‚éœ€åªæŸ¥éƒ¨åˆ†å­—æ®µï¼Œå¿…é¡»å›é€€åˆ° Wrapper æˆ– XMLï¼š

```java
// âŒ é“¾å¼ä¸æ”¯æŒ select
// userService.query().select(User::getId, User::getName)... 

// âœ… æ­£ç¡®åšæ³•ï¼šç”¨ LambdaQueryWrapper
List<User> list = userService.list(
    new LambdaQueryWrapper<User>()
        .select(User::getId, User::getName)
        .eq(User::getStatus, 1)
);
```

### âœ… 3. ä¸äº‹åŠ¡ç»“åˆ

é“¾å¼æ“ä½œæœ¬èº«æ— äº‹åŠ¡ï¼Œéœ€æ‰‹åŠ¨åŠ  `@Transactional`ï¼š

```java
@Transactional
public void transfer(Long fromId, Long toId) {
    boolean ok1 = this.update()
        .set(User::getBalance, balance - 100)
        .eq(User::getId, fromId)
        .update();

    boolean ok2 = this.update()
        .set(User::getBalance, balance + 100)
        .eq(User::getId, toId)
        .update();

    if (!ok1 || !ok2) throw new RuntimeException("è½¬è´¦å¤±è´¥");
}
```

### âœ…4. ä½¿ç”¨conditionè®¾ç½®æ¡ä»¶

æ‰€æœ‰æ¡ä»¶æ–¹æ³•éƒ½æä¾› **é‡è½½ç‰ˆæœ¬**ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸º `boolean condition`ï¼š

```
.eq(boolean condition, SFunction<T, ?> column, Object val)
.like(boolean condition, SFunction<T, ?> column, Object val)
.ge(boolean condition, SFunction<T, ?> column, Object val)
// ... å…¶ä»–æ–¹æ³•åŒç†
```

> ğŸ”¸ åªæœ‰å½“ `condition == true` æ—¶ï¼Œè¯¥æ¡ä»¶æ‰ä¼šè¢«åŠ å…¥ SQLã€‚

å¦‚ï¼š

```java
public List<User> searchUsers(String name, Integer minAge, Integer maxAge, Integer status) {
    return this.query()
        // åå­—æ¨¡ç³ŠåŒ¹é…ï¼ˆä»…å½“ name éç©ºï¼‰
        .like(StringUtils.isNotBlank(name), User::getName, name)
        
        // æœ€å°å¹´é¾„ï¼ˆä»…å½“ minAge ä¸ä¸º nullï¼‰
        .ge(minAge != null, User::getAge, minAge)
        
        // æœ€å¤§å¹´é¾„ï¼ˆä»…å½“ maxAge ä¸ä¸º nullï¼‰
        .le(maxAge != null, User::getAge, maxAge)
        
        // çŠ¶æ€ï¼ˆä»…å½“ status æœ‰æ•ˆï¼‰
        .eq(status != null && status >= 0, User::getStatus, status)
        
        .list();
}
```

------

## äº”ã€æ³¨æ„äº‹é¡¹ & é™åˆ¶

| é—®é¢˜                         | è¯´æ˜                                                         |
| ---------------------------- | ------------------------------------------------------------ |
| **ä¸æ”¯æŒå¤šè¡¨ JOIN**          | é“¾å¼ä»…é€‚ç”¨äºå•è¡¨ï¼Œå¤šè¡¨è¯·ç”¨ XML                               |
| **ä¸æ”¯æŒè‡ªå®šä¹‰ SELECT å­—æ®µ** | æ— æ³•åƒ Wrapper é‚£æ · `.select(User::getName)`                 |
| **ä¸æ”¯æŒå¤æ‚åµŒå¥—æ¡ä»¶**       | å¦‚ `(A AND B) OR (C AND D)`ï¼Œéœ€ç”¨ `and(i -> ...).or(j -> ...)`ï¼Œä½†é“¾å¼ä¸æš´éœ²æ­¤ APIï¼ˆéœ€å›é€€åˆ° Wrapperï¼‰ |
| **æ€§èƒ½**                     | åº•å±‚ä»æ˜¯ MP çš„é€šç”¨æ–¹æ³•ï¼Œæ€§èƒ½ä¸ç›´æ¥è°ƒç”¨ `list(wrapper)` ç›¸åŒ  |
| **è¿”å›å€¼**                   | `update()` è¿”å› `boolean`ï¼ˆæ˜¯å¦å½±å“è¡Œæ•° > 0ï¼‰ï¼Œä¸æ˜¯å½±å“è¡Œæ•°  |

------

## å…­ã€å®Œæ•´ç¤ºä¾‹ï¼šç”¨æˆ·ç®¡ç†åœºæ™¯

```java
@Service
public class UserServiceImpl extends ServiceImpl<UserMapper, User> implements UserService {

    // å¯ç”¨ç”¨æˆ·
    public boolean enableUser(Long id) {
        return this.update()
            .set(User::getStatus, 1)
            .set(User::getUpdateTime, LocalDateTime.now())
            .eq(User::getId, id)
            .eq(User::getStatus, 0) // ç¡®ä¿ä¹‹å‰æ˜¯ç¦ç”¨çŠ¶æ€
            .update();
    }

    // æœç´¢æ´»è·ƒç”¨æˆ·
    public List<User> searchActiveUsers(String keyword) {
        return this.query()
            .like(StringUtils.isNotBlank(keyword), User::getName, keyword)
            .eq(User::getStatus, 1)
            .ge(User::getLastLoginTime, LocalDateTime.now().minusDays(30))
            .orderByDesc(User::getLastLoginTime)
            .list();
    }

    // æ£€æŸ¥é‚®ç®±æ˜¯å¦å·²æ³¨å†Œ
    public boolean isEmailExists(String email) {
        return this.query()
            .eq(User::getEmail, email)
            .exists();
    }
}
```

------

## âœ… æ€»ç»“ï¼šä½•æ—¶ç”¨é“¾å¼è°ƒç”¨ï¼Ÿ

| åœºæ™¯                | æ¨è                       |
| ------------------- | -------------------------- |
| å•è¡¨ç®€å• CRUD       | âœ… å¼ºçƒˆæ¨èï¼ˆä»£ç ç®€æ´ï¼‰     |
| åŠ¨æ€æ¡ä»¶æŸ¥è¯¢        | âœ…ï¼ˆé…åˆ boolean æ¡ä»¶ï¼‰     |
| éœ€è¦æŒ‡å®šæŸ¥è¯¢å­—æ®µ    | âŒ ç”¨ `LambdaQueryWrapper`  |
| å¤šè¡¨å…³è” / å¤æ‚ SQL | âŒ ç”¨ XML                   |
| éœ€è¦åˆ†é¡µè¿”å› IPage  | âŒ ç”¨ `page(Page, Wrapper)` |

> ğŸ’¡ **å£è¯€**ï¼š
> **â€œå•è¡¨æ“ä½œç”¨é“¾å¼ï¼Œå­—æ®µé€‰æ‹©ç”¨ Wrapperï¼Œå¤šè¡¨å¤æ‚å†™ XMLã€‚â€**

é€šè¿‡ `IService` çš„ Lambda é“¾å¼è°ƒç”¨ï¼Œä½ å¯ä»¥å†™å‡º**ç±»å‹å®‰å…¨ã€å¯è¯»æ€§å¼ºã€é›¶ SQL å­—ç¬¦ä¸²**çš„ä¸šåŠ¡ä»£ç ï¼Œå¤§å¹…æå‡å¼€å‘ä½“éªŒå’Œç»´æŠ¤æ€§ã€‚