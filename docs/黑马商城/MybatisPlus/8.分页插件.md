---
title: MP的分页插件
date: 2026-1-29
---

MyBatis-Plus（MP）提供了**非常便捷的分页功能**，内置了 `IPage` 接口及其默认实现类 `Page`，并结合 **`BaseMapper` 的扩展方法**或 **XML 自定义 SQL** 实现高效分页。此外，MP 还支持与 **逻辑删除**、**条件构造器**等特性无缝集成。

下面从**基础用法、高级配置、注意事项**等方面详细介绍 MP 的分页机制。

------

### 一、基础用法

#### ✅ 1. 引入依赖

确保你的项目中已引入 MyBatis-Plus 相关依赖：

```xml
<dependency>
    <groupId>com.baomidou</groupId>
    <artifactId>mybatis-plus-boot-starter</artifactId>
    <version>${最新版本}</version>
</dependency>
```

#### ✅ 2. 定义实体类和 Mapper

```java
@Data
public class User {
    private Long id;
    private String name;
    private Integer age;
}

public interface UserMapper extends BaseMapper<User> {
}
```

#### ✅ 3. 配置分页插件

在 Spring Boot 配置类中注册 `PaginationInterceptor`（MP 3.x 及之前版本），或使用新的 `MybatisPlusInterceptor`（MP 3.4.0+）。

##### MP 3.x 及之前：

```java
import com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor;

@Configuration
public class MyBatisPlusConfig {
    @Bean
    public PaginationInterceptor paginationInterceptor() {
        return new PaginationInterceptor();
    }
}
```

##### MP 3.4.0+：

```java
import com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;
import com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;

@Configuration
public class MyBatisPlusConfig {
    @Bean
    public MybatisPlusInterceptor mybatisPlusInterceptor() {
        MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();
        // 设置数据库类型（MySQL, Oracle 等）
        interceptor.addInnerInterceptor(new PaginationInnerInterceptor(DbType.MYSQL));
        return interceptor;
    }
}
```

#### ✅ 4. 分页查询示例

```java
@Service
public class UserServiceImpl implements UserService {

    @Autowired
    private UserMapper userMapper;

    public IPage<User> getUsersByPage(Integer pageNum, Integer pageSize) {
        Page<User> page = new Page<>(pageNum, pageSize);
        return userMapper.selectPage(page, null); // null 表示无条件
    }
}
```

调用示例：

```java
IPage<User> pageResult = userService.getUsersByPage(1, 10);
System.out.println("总记录数：" + pageResult.getTotal());
System.out.println("当前页数据：" + pageResult.getRecords());
```

生成的 SQL 类似：

```sql
SELECT id, name, age FROM user LIMIT 10 OFFSET 0; -- MySQL 示例
```

------

### 二、带条件的分页查询

#### ✅ 使用 Wrapper 构建动态条件

```java
public IPage<User> getUsersByPageWithCondition(Integer pageNum, Integer pageSize, String name) {
    Page<User> page = new Page<>(pageNum, pageSize);
    QueryWrapper<User> wrapper = new QueryWrapper<>();
    if (StringUtils.isNotBlank(name)) {
        wrapper.like("name", name);
    }
    return userMapper.selectPage(page, wrapper);
}
```

或更推荐使用 LambdaQueryWrapper（避免硬编码字段名）：

```java
public IPage<User> getUsersByPageWithLambda(Integer pageNum, Integer pageSize, String name) {
    Page<User> page = new Page<>(pageNum, pageSize);
    LambdaQueryWrapper<User> wrapper = Wrappers.lambdaQuery();
    if (StringUtils.isNotBlank(name)) {
        wrapper.like(User::getName, name);
    }
    return userMapper.selectPage(page, wrapper);
}
```

------

### 三、高级用法

#### ✅ 1. 自定义 SQL 分页

有时你可能需要执行复杂的 SQL 查询，并希望对其进行分页处理。可以通过 XML 文件定义 SQL 并传递 `IPage` 对象。

 XML 示例：

```xml
<select id="selectUserPage" resultType="User">
    SELECT id, name, age
    FROM user
    WHERE status = 1
    <if test="ew != null and ew.sqlSegment != null">
        AND ${ew.sqlSegment}
    </if>
</select>
```

Service 层调用：

```java
public IPage<User> getUserPageWithCustomSql(Integer pageNum, Integer pageSize, String name) {
    Page<User> page = new Page<>(pageNum, pageSize);
    LambdaQueryWrapper<User> wrapper = Wrappers.lambdaQuery();
    if (StringUtils.isNotBlank(name)) {
        wrapper.like(User::getName, name);
    }
    return userMapper.selectUserPage(page, wrapper);
}
```

#### ✅ 2. 多表联查分页

对于多表联查，可以利用 `@Results` 或 `resultMap` 映射结果集，并通过 `wrapper` 动态构建条件。

```java
public IPage<UserDTO> getUsersWithDeptPage(Integer pageNum, Integer pageSize, String name) {
    Page<UserDTO> page = new Page<>(pageNum, pageSize);
    LambdaQueryWrapper<User> wrapper = Wrappers.lambdaQuery();
    if (StringUtils.isNotBlank(name)) {
        wrapper.like(User::getName, name);
    }
    return userMapper.selectJoinListPage(page, UserDTO.class, wrapper);
}
```

注意：需要在 Mapper 中定义相应的方法，并在 XML 中编写对应的 SQL 语句。

------

### 四、注意事项

#### ✅ 1. 数据库方言支持

确保分页插件正确设置了数据库类型（如 MySQL、Oracle），否则可能会导致分页不准确或 SQL 错误。

#### ✅ 2. 性能优化

- **索引**：确保分页查询涉及的列上有合适的索引，以提高查询效率。
- **延迟加载**：如果分页查询返回的数据量较大，考虑是否需要延迟加载相关关联对象。
- **缓存**：合理使用二级缓存或 Redis 缓存来减少数据库压力。

#### ✅ 3. 逻辑删除与分页

逻辑删除字段会自动加入到分页查询的条件中，即只会返回未被逻辑删除的记录。如果你需要包含逻辑删除的记录，请参考前面提到的绕过逻辑删除的方式。

------

### 五、总结

MyBatis-Plus 提供的分页功能极大地简化了分页操作，使得开发者无需手动拼接分页 SQL，减少了出错的可能性。其核心优势包括：

- **简单易用**：只需几行代码即可实现分页。
- **高度灵活**：支持自定义 SQL 和复杂条件过滤。
- **与现有功能无缝集成**：支持逻辑删除、条件构造器等特性。

通过合理配置和使用分页插件，你可以轻松应对各种分页需求，提升开发效率和系统性能。