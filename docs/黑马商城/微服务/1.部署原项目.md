---
title: 部署原项目
date: 2026-2-1
---

## linux安装与配置

### VirtualBox安装Centos7

iso：[centos-7.9.2009-isos-x86_64安装包下载-开源镜像站-阿里云](https://mirrors.aliyun.com/centos/7.9.2009/isos/x86_64/)

直接下载min版本即可，没有什么gui之类的花里胡哨的。

然后直接VirtualBox安装此iso文件即可，参数根据自己的配置来。



### 虚拟机网络设置

项目要求虚拟机能联网，主机能ping通虚拟机并ssh，那就使用桥接即可，虚拟机绑定主机网卡直连路由器，在VirtualBox的网络设置里直接选择对应网卡为桥接。

但是默认桥接没有固定的ip，每次都从路由器dhcp拿到一个ip，我们需要固定一个ip：

首先检查一下当前配置：

```bash
# 查看网卡名
nmcli con show
# 假设连接名为 "System eth0"
```

```bash
# 查看ip信息
ip addr
```

- **子网**：`192.168.0.0/24`
- **网关**：`192.168.0.1`
- **DNS**：通常也是 `192.168.0.1`（或公共 DNS 如 `8.8.8.8`）

选择一个**未被占用的 IP**，例如：`192.168.0.200`

然后根据获取到的信息完成配置编辑：

```bash
sudo nmcli con mod "System eth0" \
  ipv4.addresses 192.168.0.200/24 \
  ipv4.gateway 192.168.0.1 \
  ipv4.dns "8.8.8.8,114.114.114.114" \
  ipv4.method manual
```

> ip注意和原来的桥接模式在同一网段（一般前24位一致即可）
>
> 网关和原来的一致；dns自选
>
> 模式一定要改为manual固定ip

重启以应用：

```bash
sudo nmcli con down "System eth0" && sudo nmcli con up "System eth0"
```

验证一下：

```bash
ip addr show
ping www.baidu.com          # 测试外网
```

然后就可以用ssh工具直连虚拟机了。



### ssh工具MobarXterm

安装：[MobaXterm free Xserver and tabbed SSH client for Windows](https://mobaxterm.mobatek.net/)

项目使用ssh，点击session，选择ssh，根据刚刚搞的ip地址等填入连接信息即可。

记得在setting的terminal中打开右键粘贴

> 有了ssh之后，不想看见VirtualBox的虚拟机窗口可以使用**无头启动（start without gui）**



## 安装docker

### yum更新

安装docker之前先完成yum的更新，Centos7已经不维护了，要先给yum配置镜像源：

[CentOS7配置阿里云镜像源（超详细过程）_centos7 一键配置 配置阿里源脚本-CSDN博客](https://blog.csdn.net/KingveyLee/article/details/114984534)

然后安装docker需要的yum工具：

```bash
sudo yum install -y yum-utils device-mapper-persistent-data lvm2
```

配置docker的yum下载源：

```bash
sudo yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo

sudo sed -i 's+download.docker.com+mirrors.aliyun.com/docker-ce+' /etc/yum.repos.d/docker-ce.repo
```

更新一下缓存：

```bash
sudo yum makecache fast
```



### 安装docker

yum安装：

```bash
yum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin
```

配置一下开机启动：

```bash
# 启动Docker
systemctl start docker

# 停止Docker
systemctl stop docker

# 重启
systemctl restart docker

# 设置开机自启
systemctl enable docker

# 执行docker ps命令，如果不报错，说明安装启动成功
docker ps
```



### 配置docker镜像源

docker一般被墙了，得配置一下镜像源：

```bash
# 创建目录
mkdir -p /etc/docker

# 复制内容
tee /etc/docker/daemon.json <<-'EOF'
{
    "registry-mirrors": [
        "http://hub-mirror.c.163.com",
        "https://mirrors.tuna.tsinghua.edu.cn",
        "http://mirrors.sohu.com",
        "https://ustc-edu-cn.mirror.aliyuncs.com",
        "https://ccr.ccs.tencentyun.com",
        "https://docker.m.daocloud.io",
        "https://docker.awsl9527.cn"
    ]
}
EOF

# 重新加载配置
systemctl daemon-reload

# 重启Docker
systemctl restart docker
```



## docker部署项目

### 部署mysql容器

先做一个网络空间：

```bash
docker network create hm-net
```

挂载mysql初始化文件

```bash
docker run -d \
  --name mysql \
  -p 3306:3306 \
  -e TZ=Asia/Shanghai \
  -e MYSQL_ROOT_PASSWORD=123 \
  -v /root/mysql/data:/var/lib/mysql \
  -v /root/mysql/conf:/etc/mysql/conf.d \
  -v /root/mysql/init:/docker-entrypoint-initdb.d \
  --network hm-net\
  mysql
```

> mysql版本根据自己安装的image来
