import{_ as s,c as a,e,o as t}from"./app-DI6YVXtA.js";const p={};function l(i,n){return t(),a("div",null,[...n[0]||(n[0]=[e(`<p>Nacosï¼ˆ<strong>Dynamic Naming and Configuration Service</strong>ï¼‰æ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ <strong>æœåŠ¡å‘ç° + é…ç½®ç®¡ç†</strong> ä¸­é—´ä»¶ï¼Œä½œä¸º Spring Cloud ç”Ÿæ€çš„é‡è¦ç»„ä»¶ï¼Œå…¶<strong>é…ç½®ç®¡ç†ï¼ˆConfiguration Managementï¼‰</strong> åŠŸèƒ½å¯æ›¿ä»£ Spring Cloud Configï¼Œæä¾›<strong>åŠ¨æ€ã€é›†ä¸­ã€å®æ—¶ç”Ÿæ•ˆ</strong>çš„å¤–éƒ¨åŒ–é…ç½®èƒ½åŠ›ã€‚</p><h3 id="åŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬æ¦‚å¿µ"><span>åŸºæœ¬æ¦‚å¿µ</span></a></h3><p><strong>ä¸ºä»€ä¹ˆ</strong>éœ€è¦é…ç½®ä¸­å¿ƒï¼š</p><table><thead><tr><th style="text-align:left;">ä¼ ç»Ÿæ–¹å¼ï¼ˆå¦‚ application.ymlï¼‰</th><th style="text-align:left;">Nacos é…ç½®ä¸­å¿ƒ</th></tr></thead><tbody><tr><td style="text-align:left;">é…ç½®å†™æ­»åœ¨é¡¹ç›®ä¸­ï¼Œæ”¹é…ç½®éœ€é‡æ–°æ‰“åŒ…éƒ¨ç½²</td><td style="text-align:left;">é…ç½®å¤–ç½®ï¼Œ<strong>è¿è¡Œæ—¶åŠ¨æ€ä¿®æ”¹</strong></td></tr><tr><td style="text-align:left;">å¤šç¯å¢ƒï¼ˆdev/test/prodï¼‰éœ€ç»´æŠ¤å¤šä»½æ–‡ä»¶</td><td style="text-align:left;"><strong>ç»Ÿä¸€ç®¡ç†æ‰€æœ‰ç¯å¢ƒé…ç½®</strong></td></tr><tr><td style="text-align:left;">æ— æ³•ç°åº¦å‘å¸ƒé…ç½®</td><td style="text-align:left;">æ”¯æŒ <strong>é…ç½®ç‰ˆæœ¬ã€å›æ»šã€ç°åº¦</strong></td></tr><tr><td style="text-align:left;">æ— å˜æ›´è®°å½•å’Œæƒé™æ§åˆ¶</td><td style="text-align:left;">æä¾› <strong>æ“ä½œå®¡è®¡ã€æƒé™ç®¡ç†ã€ç›‘å¬é€šçŸ¥</strong></td></tr></tbody></table><p>nacosçš„é…ç½®ç®¡ç†<strong>æ¦‚å¿µ</strong>ï¼š</p><table><thead><tr><th style="text-align:left;">æ¦‚å¿µ</th><th style="text-align:left;">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>Namespace</strong></td><td style="text-align:left;"><strong>æœ€é«˜çº§éš”ç¦»å•ä½</strong>ï¼Œç”¨äºåŒºåˆ†<strong>ä¸åŒç¯å¢ƒ</strong>ï¼ˆå¦‚ dev / test / prodï¼‰æˆ–<strong>ä¸åŒç§Ÿæˆ·</strong></td></tr><tr><td style="text-align:left;"><strong>Group</strong></td><td style="text-align:left;">é…ç½®åˆ†ç»„ï¼Œé»˜è®¤ <code>DEFAULT_GROUP</code>ï¼Œå¯ç”¨äºåŒºåˆ†é¡¹ç›®æˆ–ç¯å¢ƒ</td></tr><tr><td style="text-align:left;"><strong>Data ID</strong></td><td style="text-align:left;">é…ç½®çš„å”¯ä¸€æ ‡è¯†ï¼Œé€šå¸¸æ ¼å¼ï¼š<code>\${prefix}-\${spring.profiles.active}.\${file-extension}</code> ä¾‹å¦‚ï¼š<code>user-service-dev.yaml</code></td></tr><tr><td style="text-align:left;"><strong>é…ç½®å†…å®¹</strong></td><td style="text-align:left;">æ”¯æŒ <strong>Propertiesã€YAMLã€JSONã€TEXT</strong> ç­‰æ ¼å¼</td></tr></tbody></table><blockquote><p>ğŸ“Œ æ¨èç»“æ„ï¼š</p><ul><li><strong>Namespace</strong> â†’ ç¯å¢ƒï¼ˆdev / prodï¼‰</li><li><strong>Group</strong> â†’ é¡¹ç›®æˆ–å¾®æœåŠ¡ç»„ï¼ˆå¦‚ <code>USER_GROUP</code>ï¼‰</li><li><strong>Data ID</strong> â†’ å…·ä½“æœåŠ¡é…ç½®ï¼ˆå¦‚ <code>order-service.yaml</code>ï¼‰</li></ul></blockquote><p>nacosçš„é…ç½®è·å–<strong>æµç¨‹</strong>ï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line"> [åº”ç”¨å¯åŠ¨]</span>
<span class="line">     â†“</span>
<span class="line">1. åˆå§‹åŒ– Bootstrap Contextï¼ˆæˆ– ConfigData åŠ è½½å™¨ï¼‰</span>
<span class="line">     â†“</span>
<span class="line">2. æ ¹æ®é…ç½®ç¡®å®šè¦åŠ è½½çš„ Data ID åˆ—è¡¨ï¼š</span>
<span class="line">   - ä¸»é…ç½®ï¼š\${spring.application.name}-\${spring.profiles.active}.\${file-extension}</span>
<span class="line">   - å…±äº«é…ç½®ï¼šshared-configs ä¸­çš„ dataId åˆ—è¡¨</span>
<span class="line">     â†“</span>
<span class="line">3. å‘ Nacos Server å‘èµ· HTTP GET è¯·æ±‚ï¼ˆ/nacos/v1/cs/configsï¼‰</span>
<span class="line">   å‚æ•°ï¼šdataId, group, namespace, tenant</span>
<span class="line">     â†“</span>
<span class="line">4. Nacos Server æŸ¥è¯¢é…ç½®ï¼ˆä»å†…å­˜ç¼“å­˜ â†’ æ•°æ®åº“ï¼‰</span>
<span class="line">     â†“</span>
<span class="line">5. è¿”å›é…ç½®å†…å®¹ï¼ˆå­—ç¬¦ä¸²ï¼‰ç»™å®¢æˆ·ç«¯</span>
<span class="line">     â†“</span>
<span class="line">6. å®¢æˆ·ç«¯å°†é…ç½®è§£æä¸º PropertySourceï¼Œæ³¨å…¥ Spring Environment</span>
<span class="line">     â†“</span>
<span class="line">7. Spring åˆ›å»º DataSourceã€MyBatis ç­‰ Beanï¼ˆä½¿ç”¨ Nacos é…ç½®ï¼‰</span>
<span class="line">     â†“</span>
<span class="line">8. ã€è¿è¡Œæ—¶ã€‘å¯åŠ¨é•¿è½®è¯¢ï¼ˆLong Pollingï¼‰ç›‘å¬é…ç½®å˜æ›´</span>
<span class="line">     â†“</span>
<span class="line">9. ç”¨æˆ·åœ¨ Nacos æ§åˆ¶å°ä¿®æ”¹é…ç½® â†’ Server æ¨é€å˜æ›´é€šçŸ¥</span>
<span class="line">     â†“</span>
<span class="line">10. å®¢æˆ·ç«¯é‡æ–°æ‹‰å–æœ€æ–°é…ç½® â†’ è§¦å‘ @RefreshScope Bean é‡å»º</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä½¿ç”¨æ³¨æ„äº‹é¡¹" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ³¨æ„äº‹é¡¹"><span>ä½¿ç”¨æ³¨æ„äº‹é¡¹</span></a></h3><h4 id="dataidå¿…é¡»åŠ ä¸Šæ–‡ä»¶åç¼€" tabindex="-1"><a class="header-anchor" href="#dataidå¿…é¡»åŠ ä¸Šæ–‡ä»¶åç¼€"><span>DataIDå¿…é¡»åŠ ä¸Šæ–‡ä»¶åç¼€</span></a></h4><p>åç¼€æ²¡åŠ /é”™è¯¯ä¹Ÿä¼šå¯¼è‡´nacosæ‰¾ä¸åˆ°æ‰€éœ€è¦çš„é…ç½®æ–‡ä»¶ã€‚</p><h4 id="ä¸åŒ-namespace-ä¹‹é—´çš„é…ç½®å®Œå…¨éš”ç¦»-æ— æ³•äº’ç›¸è®¿é—®" tabindex="-1"><a class="header-anchor" href="#ä¸åŒ-namespace-ä¹‹é—´çš„é…ç½®å®Œå…¨éš”ç¦»-æ— æ³•äº’ç›¸è®¿é—®"><span>ä¸åŒ Namespace ä¹‹é—´çš„é…ç½®å®Œå…¨éš”ç¦»ï¼Œæ— æ³•äº’ç›¸è®¿é—®</span></a></h4><p>devï¼Œpropç­‰namespaceåœ¨æœåŠ¡çš„bootstrap/applicationä¸­åªèƒ½æŒ‡å®šä¸€ä¸ªï¼ä¸å¯åœ¨åŒä¸€æœåŠ¡ä¸­ä½¿ç”¨å¤šä¸ªä¸åŒnamespaceçš„é…ç½®æ–‡ä»¶ï¼</p><h4 id="ä½¿ç”¨bootstrapä½œä¸ºå¼•å…¥nacosé…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨bootstrapä½œä¸ºå¼•å…¥nacosé…ç½®æ–‡ä»¶"><span>ä½¿ç”¨bootstrapä½œä¸ºå¼•å…¥nacosé…ç½®æ–‡ä»¶</span></a></h4><blockquote><p><strong>Spring Boot æœ¬èº«å¹¶ä¸å¼ºåˆ¶è¦æ±‚ä½¿ç”¨ <code>bootstrap.yml</code>ï¼Œä½† Spring Cloudï¼ˆåŒ…æ‹¬ Nacos Configï¼‰ä¸ºäº†ä¿è¯â€œé…ç½®æ—©äºåº”ç”¨ä¸Šä¸‹æ–‡åˆå§‹åŒ–â€ï¼Œå¿…é¡»ä½¿ç”¨ <code>bootstrap</code> é˜¶æ®µåŠ è½½é…ç½®ä¸­å¿ƒçš„è¿æ¥ä¿¡æ¯ã€‚</strong></p></blockquote><p>Spring Boot åº”ç”¨å¯åŠ¨æµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">1. åˆ›å»º Bootstrap Contextï¼ˆå¼•å¯¼ä¸Šä¸‹æ–‡ï¼‰</span>
<span class="line">   â””â”€â”€ åŠ è½½ bootstrap.yml / bootstrap.properties</span>
<span class="line">   â””â”€â”€ åˆå§‹åŒ– Spring Cloud ç»„ä»¶ï¼ˆå¦‚ Nacos Clientï¼‰</span>
<span class="line">   â””â”€â”€ ä» Nacos æ‹‰å–è¿œç¨‹é…ç½®</span>
<span class="line"></span>
<span class="line">2. åˆ›å»º Application Contextï¼ˆä¸»åº”ç”¨ä¸Šä¸‹æ–‡ï¼‰</span>
<span class="line">   â””â”€â”€ åŠ è½½ application.yml</span>
<span class="line">   â””â”€â”€ åˆ›å»º @Beanï¼ˆå¦‚ DataSourceã€MyBatis ç­‰ï¼‰</span>
<span class="line">   â””â”€â”€ å¯åŠ¨ Web å®¹å™¨</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>âš ï¸ <strong>å…³é”®ç‚¹</strong>ï¼š <strong>DataSourceã€Redis ç­‰ Bean çš„åˆ›å»ºä¾èµ– <code>application.yml</code> ä¸­çš„é…ç½®</strong>ï¼Œ è€Œè¿™äº›é…ç½®å¯èƒ½æ¥è‡ª <strong>Nacos</strong>ã€‚ æ‰€ä»¥å¿…é¡»åœ¨ <strong>Application Context åˆå§‹åŒ–ä¹‹å‰</strong> å°±è¿æ¥ Nacos å¹¶æ‹‰å–é…ç½®ï¼</p></blockquote><p>è¿™å°±éœ€è¦ä¸€ä¸ª <strong>æ¯” <code>application.yml</code> æ›´æ—©åŠ è½½çš„é…ç½®æ–‡ä»¶</strong> â†’ <strong><code>bootstrap.yml</code></strong></p><p>å¦‚æœä¸ç”¨**<code>bootstrap.yml</code>**ï¼š</p><ol><li>Spring å…ˆè¯» <code>application.yml</code></li><li>å‘ç° <code>datasource.url</code> æœªå®šä¹‰ï¼ˆå› ä¸º Nacos è¿˜æ²¡è¿ï¼‰</li><li>å°è¯•åˆ›å»º <code>DataSource</code> Bean â†’ æŠ¥é”™ï¼š<code>url is null</code></li><li><strong>æ ¹æœ¬æ²¡æœºä¼šå»è¿ Nacosï¼</strong></li></ol><p><strong>ä½†å…¶å®æ–°ç‰ˆæœ¬æˆ‘ä»¬å¯ä»¥ç›´è¿nacosï¼Œåªè¦æŒ‰ä»¥ä¸‹é…ç½®ä¹Ÿå¯ä»¥ä¸å»å‡†å¤‡bootstrapæ–‡ä»¶ï¼š</strong></p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token comment"># application.yml</span></span>
<span class="line"><span class="token key atrule">spring</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">application</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">name</span><span class="token punctuation">:</span> user<span class="token punctuation">-</span>service</span>
<span class="line"></span>
<span class="line">  <span class="token key atrule">config</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">import</span><span class="token punctuation">:</span> </span>
<span class="line">      <span class="token punctuation">-</span> optional<span class="token punctuation">:</span>nacos<span class="token punctuation">:</span>user<span class="token punctuation">-</span>service.yaml  <span class="token comment"># ä» Nacos åŠ è½½é…ç½®</span></span>
<span class="line"></span>
<span class="line">  <span class="token key atrule">cloud</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">nacos</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">config</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 127.0.0.1<span class="token punctuation">:</span><span class="token number">8848</span></span>
<span class="line">        <span class="token key atrule">group</span><span class="token punctuation">:</span> DEFAULT_GROUP</span>
<span class="line">        <span class="token key atrule">namespace</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span>  <span class="token comment"># public å‘½åç©ºé—´</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>è€ç‰ˆæœ¬ä¸èƒ½åœ¨ä¸€ä¸ªä¸Šä¸‹æ–‡ä¸­å®Œæˆï¼Œæ˜¯å› ä¸º Nacos å®¢æˆ·ç«¯ä¾èµ– Spring å®¹å™¨ï¼Œè€Œå®¹å™¨åˆ›å»ºåˆä¾èµ–é…ç½®ï¼Œå½¢æˆæ­»é”ï¼› æ–°ç‰ˆæœ¬é€šè¿‡ Config Data API è®© Nacos å®¢æˆ·ç«¯è„±ç¦»å®¹å™¨ï¼Œä»¥â€œé…ç½®åŠ è½½æ’ä»¶â€å½¢å¼åœ¨å®¹å™¨åˆå§‹åŒ–è¿‡ç¨‹ä¸­ç›´æ¥æ‹‰å–é…ç½®ï¼Œä»è€Œæ‰“ç ´æ­»é”ã€‚</strong></p><p>æ–°ç‰ˆæœ¬è£…è½½contextæµç¨‹ï¼š</p><ol><li><strong>å¯åŠ¨ Application Context</strong></li><li><strong>è§£æ <code>application.yml</code>ï¼Œé‡åˆ° <code>spring.config.import: nacos:xxx</code></strong></li><li>æš‚åœå¸¸è§„é…ç½®åŠ è½½ï¼Œè½¬è€Œï¼š <ul><li>ä½¿ç”¨ <strong>å†…ç½®çš„ã€é Spring å®¹å™¨ç®¡ç†çš„ Nacos å®¢æˆ·ç«¯</strong>ï¼ˆçº¯ Java å·¥å…·ç±»ï¼‰</li><li>ç›´æ¥è°ƒç”¨ Nacos HTTP API æ‹‰å–é…ç½®ï¼ˆä¸ä¾èµ– <code>@Bean</code>ï¼‰</li></ul></li><li><strong>å°†æ‹‰å–çš„é…ç½®ä½œä¸ºæ–°çš„ PropertySource æ’å…¥ Environment</strong></li><li><strong>ç»§ç»­å®Œæˆå‰©ä½™é…ç½®è§£æå’Œ Bean åˆ›å»º</strong></li></ol></blockquote><table><thead><tr><th style="text-align:left;">ç‰¹æ€§</th><th style="text-align:left;"><code>bootstrap.yml</code>æ–¹å¼</th><th style="text-align:left;"><code>application.yml + spring.config.import</code></th></tr></thead><tbody><tr><td style="text-align:left;"><strong>Spring Boot ç‰ˆæœ¬</strong></td><td style="text-align:left;">æ‰€æœ‰ç‰ˆæœ¬ï¼ˆåŒ…æ‹¬ 2.4+ï¼‰</td><td style="text-align:left;"><strong>ä»… Spring Boot 2.4+</strong></td></tr><tr><td style="text-align:left;"><strong>æ˜¯å¦éœ€è¦é¢å¤–ä¾èµ–</strong></td><td style="text-align:left;">éœ€è¦ <code>spring-cloud-starter-bootstrap</code></td><td style="text-align:left;">ä¸éœ€è¦ï¼ˆå†…ç½®æ”¯æŒï¼‰</td></tr><tr><td style="text-align:left;"><strong>é…ç½®åŠ è½½é¡ºåº</strong></td><td style="text-align:left;">Bootstrap Context â†’ Application Context</td><td style="text-align:left;">å•ä¸€ä¸Šä¸‹æ–‡ï¼ŒæŒ‰ <code>import</code> é¡ºåºåŠ è½½</td></tr><tr><td style="text-align:left;"><strong>ç¤¾åŒºæˆç†Ÿåº¦</strong></td><td style="text-align:left;">âœ… éå¸¸æˆç†Ÿï¼Œæ–‡æ¡£ä¸°å¯Œ</td><td style="text-align:left;">è¾ƒæ–°ï¼Œéƒ¨åˆ†ä¼ä¸šå°šæœªè¿ç§»</td></tr><tr><td style="text-align:left;"><strong>æ¨èåœºæ™¯</strong></td><td style="text-align:left;">ä¼ ç»Ÿé¡¹ç›®ã€ç¨³å®šç”Ÿäº§ç¯å¢ƒ</td><td style="text-align:left;">æ–°é¡¹ç›®ã€æ‹¥æŠ± Spring Boot æ–°ç‰¹æ€§</td></tr></tbody></table><blockquote><p>å½“ç„¶åœ¨æ–°ç‰ˆæœ¬ä¸­ä½¿ç”¨bootstrapä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œæ›´åŠ ä¿é™©ä¸€ç‚¹</p></blockquote><h3 id="é…ç½®ä¸ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#é…ç½®ä¸ä½¿ç”¨"><span>é…ç½®ä¸ä½¿ç”¨</span></a></h3><h4 id="nacoså‡†å¤‡é…ç½®æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#nacoså‡†å¤‡é…ç½®æ–‡ä»¶"><span>Nacoså‡†å¤‡é…ç½®æ–‡ä»¶</span></a></h4><p>è®¿é—®8848ï¼Œæˆ‘ä»¬å…ˆæ–°å»ºä¸€ä¸ª<strong>jdbc</strong>çš„ç»Ÿä¸€é…ç½®æ–‡ä»¶ï¼š</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">spring</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">datasource</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//$<span class="token punctuation">{</span>hm.db.host<span class="token punctuation">:</span>192.168.0.200<span class="token punctuation">}</span><span class="token punctuation">:</span>$<span class="token punctuation">{</span>hm.db.port<span class="token punctuation">:</span><span class="token number">3306</span><span class="token punctuation">}</span>/$<span class="token punctuation">{</span>hm.db.database<span class="token punctuation">}</span><span class="token punctuation">?</span>useUnicode=true<span class="token important">&amp;characterEncoding=UTF-8&amp;autoReconnect=true&amp;serverTimezone=Asia/Shanghai</span></span>
<span class="line">    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver</span>
<span class="line">    <span class="token key atrule">username</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>hm.db.un<span class="token punctuation">:</span>root<span class="token punctuation">}</span></span>
<span class="line">    <span class="token key atrule">password</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>hm.db.pw<span class="token punctuation">:</span><span class="token number">123</span><span class="token punctuation">}</span></span>
<span class="line"><span class="token key atrule">mybatis-plus</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">configuration</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">default-enum-type-handler</span><span class="token punctuation">:</span> com.baomidou.mybatisplus.core.handlers.MybatisEnumTypeHandler</span>
<span class="line">  <span class="token key atrule">global-config</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">db-config</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">update-strategy</span><span class="token punctuation">:</span> not_null</span>
<span class="line">      <span class="token key atrule">id-type</span><span class="token punctuation">:</span> auto	</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>\${...}</code> å ä½ç¬¦è‹¥å¸¦ä¸Š<code>\${path:value}</code>ä¸­çš„<code>:value</code>ï¼Œå…¶ä¸­çš„valueå°±æ˜¯é»˜è®¤å€¼ï¼ˆä¸æ˜¾ç¤ºå£°æ˜è‡ªåŠ¨ä½¿ç”¨é»˜è®¤å€¼ï¼‰</p><p><strong>è¿™æ®µé…ç½®ä¸­çš„ <code>\${...}</code> å ä½ç¬¦ï¼ˆåŒ…æ‹¬é»˜è®¤å€¼å¦‚ <code>\${hm.db.host:192.168.0.200}</code>ï¼‰æ˜¯ç”± Spring Boot çš„é…ç½®è§£ææœºåˆ¶å®Œæˆçš„ï¼Œè€Œä¸æ˜¯ç”± Nacos æˆ–å…¶ä»–å¤–éƒ¨ç»„ä»¶å¤„ç†çš„ã€‚</strong></p></blockquote><p>å†æä¸€ä¸ªlogçš„ç»Ÿä¸€é…ç½®æ–‡ä»¶ï¼š</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">logging</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">level</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">com.hmall</span><span class="token punctuation">:</span> debug</span>
<span class="line">  <span class="token key atrule">pattern</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">dateformat</span><span class="token punctuation">:</span> HH<span class="token punctuation">:</span>mm<span class="token punctuation">:</span>ss<span class="token punctuation">:</span>SSS</span>
<span class="line">  <span class="token key atrule">file</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">path</span><span class="token punctuation">:</span> <span class="token string">&quot;logs/\${spring.application.name}&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å’Œswaggerçš„ç»Ÿä¸€é…ç½®ï¼š</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">knife4j</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">enable</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></span>
<span class="line">  <span class="token key atrule">openapi</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">title</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>hm.swagger.title<span class="token punctuation">:</span>é»‘é©¬å•†åŸæ¥å£æ–‡æ¡£<span class="token punctuation">}</span></span>
<span class="line">    <span class="token key atrule">description</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>hm.swagger.description<span class="token punctuation">:</span>é»‘é©¬å•†åŸæ¥å£æ–‡æ¡£<span class="token punctuation">}</span></span>
<span class="line">    <span class="token key atrule">email</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>hm.swagger.email<span class="token punctuation">:</span>zhanghuyi@itcast.cn<span class="token punctuation">}</span></span>
<span class="line">    <span class="token key atrule">concat</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>hm.swagger.concat<span class="token punctuation">:</span>è™å“¥<span class="token punctuation">}</span></span>
<span class="line">    <span class="token key atrule">url</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//www.itcast.cn</span>
<span class="line">    <span class="token key atrule">version</span><span class="token punctuation">:</span> v1.0.0</span>
<span class="line">    <span class="token key atrule">group</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">default</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">group-name</span><span class="token punctuation">:</span> default</span>
<span class="line">        <span class="token key atrule">api-rule</span><span class="token punctuation">:</span> package</span>
<span class="line">        <span class="token key atrule">api-rule-resources</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token punctuation">-</span> $<span class="token punctuation">{</span>hm.swagger.package<span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™æ ·æˆ‘ä»¬å°±å®Œæˆäº†Nacosé…ç½®ä¸­å¿ƒçš„é…ç½®æ–‡ä»¶å‡†å¤‡ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å®ŒæˆSpringBooté¡¹ç›®çš„é…ç½®ï¼š</p><h4 id="å¼•å…¥ä¾èµ–" tabindex="-1"><a class="header-anchor" href="#å¼•å…¥ä¾èµ–"><span>å¼•å…¥ä¾èµ–</span></a></h4><p>åœ¨<strong>çˆ¶é¡¹ç›®pom</strong>ä¸­åšå¥½ä¾èµ–ç‰ˆæœ¬ç®¡ç†ï¼š</p><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml" data-title="xml"><pre><code><span class="line"><span class="token comment">&lt;!--spring cloud--&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${spring-cloud.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token comment">&lt;!--spring cloud alibaba--&gt;</span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-alibaba-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>\${spring-cloud-alibaba.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>æ³¨æ„alibabaä¸cloudæœ¬ä½“ç‰ˆæœ¬æ˜ å°„å…³ç³»ï¼</p></blockquote><p>ç„¶åå†åœ¨éœ€è¦çš„<strong>å­é¡¹ç›®pom</strong>ä¸­ç›´æ¥å¼•å…¥ä¾èµ–å³å¯ï¼š</p><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml" data-title="xml"><pre><code><span class="line">  <span class="token comment">&lt;!--nacosé…ç½®ç®¡ç†--&gt;</span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-nacos-config<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token comment">&lt;!--è¯»å–bootstrapæ–‡ä»¶--&gt;</span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-bootstrap<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="æœ¬åœ°é…ç½®æ–‡ä»¶ç¼–å†™" tabindex="-1"><a class="header-anchor" href="#æœ¬åœ°é…ç½®æ–‡ä»¶ç¼–å†™"><span>æœ¬åœ°é…ç½®æ–‡ä»¶ç¼–å†™</span></a></h4><p>é¦–å…ˆæ˜¯å¼•å…¥nacosé…ç½®çš„bootstrapæ–‡ä»¶ï¼š</p><div class="language-YML line-numbers-mode" data-highlighter="prismjs" data-ext="YML" data-title="YML"><pre><code><span class="line">spring:</span>
<span class="line">  application:</span>
<span class="line">    name: cart-service # æœåŠ¡åç§°</span>
<span class="line">  profiles:</span>
<span class="line">    active: dev</span>
<span class="line">  cloud:</span>
<span class="line">    nacos:</span>
<span class="line">      server-addr: 192.168.0.200:8848 # nacosåœ°å€</span>
<span class="line">      config:</span>
<span class="line">        file-extension: yaml # æ–‡ä»¶åç¼€å</span>
<span class="line">        shared-configs: # å…±äº«é…ç½®</span>
<span class="line">          - dataId: shared-jdbc.yml # å…±äº«mybatisé…ç½®</span>
<span class="line">          - dataId: shared-log.yml # å…±äº«æ—¥å¿—é…ç½®</span>
<span class="line">          - dataId: shared-swagger.yml # å…±äº«æ—¥å¿—é…ç½®</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ä¸å£°æ˜å‘½åç©ºé—´namespaceä»¥åŠç»„groupåˆ™ä½¿ç”¨<strong>é»˜è®¤å€¼</strong>ï¼š</p><table><thead><tr><th style="text-align:left;">é…ç½®é¡¹</th><th style="text-align:left;">é»˜è®¤å€¼</th><th style="text-align:left;">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>Namespace</strong></td><td style="text-align:left;"><code>public</code>ï¼ˆå®é™… ID ä¸ºç©ºå­—ç¬¦ä¸² <code>&quot;&quot;</code>ï¼‰</td><td style="text-align:left;">æ‰€æœ‰æœªæŒ‡å®š namespace çš„å®¢æˆ·ç«¯éƒ½è¿åˆ° public</td></tr><tr><td style="text-align:left;"><strong>Group</strong></td><td style="text-align:left;"><code>DEFAULT_GROUP</code></td><td style="text-align:left;">Nacos é…ç½®çš„é»˜è®¤åˆ†ç»„</td></tr></tbody></table><p>ç­‰ä»·äºï¼š</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">spring</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">cloud</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">nacos</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 192.168.150.101</span>
<span class="line">      <span class="token key atrule">config</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">namespace</span><span class="token punctuation">:</span> <span class="token string">&quot;&quot;</span>                <span class="token comment"># â† é»˜è®¤æ˜¯ publicï¼ˆID ä¸ºç©ºï¼‰</span></span>
<span class="line">        <span class="token key atrule">group</span><span class="token punctuation">:</span> DEFAULT_GROUP         <span class="token comment"># â† é»˜è®¤åˆ†ç»„</span></span>
<span class="line">        <span class="token key atrule">file-extension</span><span class="token punctuation">:</span> yaml</span>
<span class="line">        <span class="token key atrule">shared-configs</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token punctuation">-</span> <span class="token key atrule">dataId</span><span class="token punctuation">:</span> shared<span class="token punctuation">-</span>jdbc.yml</span>
<span class="line">            <span class="token key atrule">group</span><span class="token punctuation">:</span> DEFAULT_GROUP     <span class="token comment"># â† æ¯ä¸ª shared-config ä¹Ÿé»˜è®¤ç”¨ DEFAULT_GROUP</span></span>
<span class="line">          <span class="token punctuation">-</span> <span class="token key atrule">dataId</span><span class="token punctuation">:</span> shared<span class="token punctuation">-</span>log.yml</span>
<span class="line">            <span class="token key atrule">group</span><span class="token punctuation">:</span> DEFAULT_GROUP</span>
<span class="line">          <span class="token punctuation">-</span> <span class="token key atrule">dataId</span><span class="token punctuation">:</span> shared<span class="token punctuation">-</span>swagger.yml</span>
<span class="line">            <span class="token key atrule">group</span><span class="token punctuation">:</span> DEFAULT_GROUP</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><p>ç„¶åæ˜¯åŸºæœ¬çš„applicationæ–‡ä»¶ï¼š</p><div class="language-YML line-numbers-mode" data-highlighter="prismjs" data-ext="YML" data-title="YML"><pre><code><span class="line">server:</span>
<span class="line">  port: 8082</span>
<span class="line">feign:</span>
<span class="line">  okhttp:</span>
<span class="line">    enabled: true # å¼€å¯OKHttpè¿æ¥æ± æ”¯æŒ</span>
<span class="line">hm:</span>
<span class="line">  swagger:</span>
<span class="line">    title: è´­ç‰©è½¦æœåŠ¡æ¥å£æ–‡æ¡£</span>
<span class="line">    package: com.hmall.cart.controller</span>
<span class="line">  db:</span>
<span class="line">    database: hm-cart</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åå°±å¯ä»¥è®©SpringBooté¡¹ç›®ä»Nacosä¸­è·å–é…ç½®äº†ã€‚</p><h3 id="é…ç½®çƒ­æ›´æ–°" tabindex="-1"><a class="header-anchor" href="#é…ç½®çƒ­æ›´æ–°"><span>é…ç½®çƒ­æ›´æ–°</span></a></h3><p>ä¸šåŠ¡ä¸­æˆ‘ä»¬å¸¸å¸¸ä¼šä½¿ç”¨ä¸€äº›å†™åœ¨ymlç­‰<strong>é…ç½®æ–‡ä»¶é‡Œçš„å‚æ•°</strong>ç”¨äºå†³å®šé˜ˆå€¼ç­‰æ•°æ®ï¼Œéšåä½¿ç”¨<code>@Value</code>ï¼Œ<code>@ConfigurationProperties</code>ä»¥åŠEnvironmentç­‰æ–¹å¼ç›´æ¥<strong>æ³¨å…¥</strong>åˆ°æŒ‡å®šBeanå¯¹è±¡ä¸­å­˜å‚¨ä»¥åŠä½¿ç”¨ã€‚ä½†æ˜¯è¿™æ ·çš„æ“ä½œåœ¨æœ¬åœ°ä½¿ç”¨æ—¶ä¸€æ—¦åº”ç”¨è¿è¡Œèµ·æ¥æˆ‘ä»¬å°±åªèƒ½<strong>ä¸€ä¸ªå‚æ•°ç”¨åˆ°é‡å¯</strong>äº†ï¼Œæœ‰æ²¡æœ‰<strong>ä¸éœ€è¦é‡å¯ä¹Ÿå¯ä»¥å®ç°å…³é”®å‚æ•°å˜æ›´</strong>çš„æ“ä½œï¼Ÿ</p><p>æˆ‘ä»¬å¯ä»¥ç»“åˆnacosæä¾›çš„é…ç½®ç®¡ç†+<code>@ConfigurationProperties</code> <strong>+</strong> <code>@RefreshScope</code>æ¥å®ç°ç»Ÿä¸€çš„é…ç½®ç®¡ç†ï¼š</p><p>é¦–å…ˆåœ¨nacoså®Œæˆå‚æ•°çš„æŒ‡å®šï¼š</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token comment"># nacosä¸­çš„cart-service.ymlæ–‡ä»¶</span></span>
<span class="line"><span class="token key atrule">hm</span><span class="token punctuation">:</span></span>
<span class="line"> <span class="token key atrule">cart</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">maxItems</span><span class="token punctuation">:</span> <span class="token number">10</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åå†åœ¨å¯¹åº”SpringBooté¡¹ç›®ä¸­åŠ å…¥æ–°é…ç½®æ–‡ä»¶çš„å£°æ˜ï¼š</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">spring</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">application</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">name</span><span class="token punctuation">:</span> cart<span class="token punctuation">-</span>service <span class="token comment"># æœåŠ¡åç§°</span></span>
<span class="line">  <span class="token key atrule">profiles</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">active</span><span class="token punctuation">:</span> dev</span>
<span class="line">  <span class="token key atrule">cloud</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">nacos</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">server-addr</span><span class="token punctuation">:</span> 192.168.0.200<span class="token punctuation">:</span><span class="token number">8848</span> <span class="token comment"># nacosåœ°å€</span></span>
<span class="line">      <span class="token key atrule">config</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token key atrule">file-extension</span><span class="token punctuation">:</span> yaml <span class="token comment"># æ–‡ä»¶åç¼€å</span></span>
<span class="line">        <span class="token key atrule">shared-configs</span><span class="token punctuation">:</span> <span class="token comment"># å…±äº«é…ç½®</span></span>
<span class="line">          <span class="token punctuation">-</span> <span class="token key atrule">dataId</span><span class="token punctuation">:</span> shared<span class="token punctuation">-</span>jdbc.yml <span class="token comment"># å…±äº«mybatisé…ç½®</span></span>
<span class="line">          <span class="token punctuation">-</span> <span class="token key atrule">dataId</span><span class="token punctuation">:</span> shared<span class="token punctuation">-</span>log.yml <span class="token comment"># å…±äº«æ—¥å¿—é…ç½®</span></span>
<span class="line">          <span class="token punctuation">-</span> <span class="token key atrule">dataId</span><span class="token punctuation">:</span> shared<span class="token punctuation">-</span>swagger.yml <span class="token comment"># å…±äº«æ—¥å¿—é…ç½®</span></span>
<span class="line">          <span class="token punctuation">-</span> <span class="token key atrule">dataId</span><span class="token punctuation">:</span> cart<span class="token punctuation">-</span>service.yml <span class="token comment"># æœåŠ¡é…ç½®</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬å°±å¯ä»¥ä»applicationContextä¸Šä¸‹æ–‡ä¸­è·å–åˆ°æ•°æ®äº†ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@Component</span></span>
<span class="line"><span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">&quot;hm.cart&quot;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token annotation punctuation">@RefreshScope</span></span>
<span class="line"><span class="token annotation punctuation">@Data</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CartProperties</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token comment">// æœ€å¤§è´­ç‰©è½¦æ•°é‡</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token class-name">Integer</span> maxItems<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>propertiesç±»åœ¨ä¸šåŠ¡ä¸­æ³¨å…¥å³å¯ä½¿ç”¨æ•°æ®äº†ï¼š</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line"><span class="token annotation punctuation">@Service</span></span>
<span class="line"><span class="token annotation punctuation">@RequiredArgsConstructor</span></span>
<span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CartServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CartMapper</span><span class="token punctuation">,</span> <span class="token class-name">Cart</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">ICartService</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">CartProperties</span> cartProperties<span class="token punctuation">;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></span>
<span class="line">        </span>
<span class="line">    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">checkCartsFull</span><span class="token punctuation">(</span><span class="token class-name">Long</span> userId<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token function">lambdaQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">Cart</span><span class="token operator">::</span><span class="token function">getUserId</span><span class="token punctuation">,</span> userId<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;=</span> cartProperties<span class="token punctuation">.</span><span class="token function">getMaxItems</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// ç›´æ¥è·å–åˆ°æ•°æ®</span></span>
<span class="line">            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BizIllegalException</span><span class="token punctuation">(</span><span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;ç”¨æˆ·è´­ç‰©è½¦è¯¾ç¨‹ä¸èƒ½è¶…è¿‡{}&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>åŸºäºnacosçš„æ•°æ®é…ç½®æ–‡ä»¶åœ¨ä½¿ç”¨nacosæ›´æ–°æ—¶ä¼šç›´æ¥æ¨é€åˆ°ä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶çš„æœåŠ¡ä¸­ï¼Œè¯¥æœåŠ¡ä¸ç”¨é‡å¯å³å¯æ›´æ–°å¯¹åº”æ•°æ®ã€‚</p>`,62)])])}const o=s(p,[["render",l]]),u=JSON.parse('{"path":"/docs/heimashangcheng/weifuwu/6.peizhiguanliï¼ˆpeizhizhongxinNacosï¼‰.html","title":"é…ç½®ä¸­å¿ƒ","lang":"en-US","frontmatter":{"title":"é…ç½®ä¸­å¿ƒ","date":"2026-2-8"},"headers":[{"level":3,"title":"åŸºæœ¬æ¦‚å¿µ","slug":"åŸºæœ¬æ¦‚å¿µ","link":"#åŸºæœ¬æ¦‚å¿µ","children":[]},{"level":3,"title":"ä½¿ç”¨æ³¨æ„äº‹é¡¹","slug":"ä½¿ç”¨æ³¨æ„äº‹é¡¹","link":"#ä½¿ç”¨æ³¨æ„äº‹é¡¹","children":[]},{"level":3,"title":"é…ç½®ä¸ä½¿ç”¨","slug":"é…ç½®ä¸ä½¿ç”¨","link":"#é…ç½®ä¸ä½¿ç”¨","children":[]},{"level":3,"title":"é…ç½®çƒ­æ›´æ–°","slug":"é…ç½®çƒ­æ›´æ–°","link":"#é…ç½®çƒ­æ›´æ–°","children":[]}],"git":{"createdTime":1771155821000,"updatedTime":1771155821000,"contributors":[{"name":"SaltFishGC","email":"130335482+SaltFishGC@users.noreply.github.com","commits":1}]},"filePathRelative":"docs/é»‘é©¬å•†åŸ/å¾®æœåŠ¡/6.é…ç½®ç®¡ç†ï¼ˆé…ç½®ä¸­å¿ƒNacosï¼‰.md"}');export{o as comp,u as data};
