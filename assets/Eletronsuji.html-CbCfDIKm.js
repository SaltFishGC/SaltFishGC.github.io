import{_ as s,c as a,b as t,o as e}from"./app-DizMuLvU.js";const p={};function o(c,n){return e(),a("div",null,[...n[0]||(n[0]=[t(`<h3 id="渲染线程vue与主线程" tabindex="-1"><a class="header-anchor" href="#渲染线程vue与主线程"><span>渲染线程vue与主线程</span></a></h3><p>主线程才能和本地交互</p><h4 id="渲染线程与主线程之间的交互" tabindex="-1"><a class="header-anchor" href="#渲染线程与主线程之间的交互"><span>渲染线程与主线程之间的交互</span></a></h4><p>ipc</p><p>on与send</p><p>需要回调函数且不需要返回值</p><p>handle与invoke（双向通信）</p><p>需要返回值</p><p>如果是分开配置的，记得在主线程index里面导入ipc的方法</p><table><thead><tr><th>特性</th><th><code>send</code> + <code>on</code></th><th><code>invoke</code> + <code>handle</code></th></tr></thead><tbody><tr><td><strong>通信方向</strong></td><td>单向（渲染 → 主）或 双向（需手动 <code>reply</code>）</td><td>双向（支持返回值）</td></tr><tr><td><strong>能否返回数据</strong></td><td>❌ 不能直接返回（需用 <code>reply</code>）</td><td>✅ 可以 <code>return</code> 数据（支持 <code>Promise</code>）</td></tr><tr><td><strong>是否异步（await）</strong></td><td>❌ 不支持 <code>await</code>，只能用事件</td><td>✅ 支持 <code>await</code>，可 <code>async/await</code></td></tr><tr><td><strong>错误处理</strong></td><td>需手动发送错误事件</td><td>✅ <code>throw</code> 错误会自动 reject Promise</td></tr><tr><td><strong>Electron 版本要求</strong></td><td>所有版本</td><td><code>handle</code>/<code>invoke</code> 需要 <strong>Electron &gt;= 7</strong></td></tr><tr><td><strong>推荐使用场景</strong></td><td>简单通知、事件广播</td><td>需要等待结果的请求（如读文件、数据库查询）</td></tr></tbody></table><table><thead><tr><th>场景</th><th>推荐方式</th></tr></thead><tbody><tr><td>获取数据（如读文件、查数据库）</td><td>✅ <code>invoke</code> + <code>handle</code></td></tr><tr><td>触发操作但不需要返回值（如打开窗口、播放音乐）</td><td>✅ <code>send</code> + <code>on</code></td></tr><tr><td>通知类事件（如&quot;用户登录了&quot;）</td><td>✅ <code>send</code> + <code>on</code>（主进程广播）</td></tr><tr><td>需要等待结果的 UI 操作</td><td>✅ <code>invoke</code> + <code>handle</code></td></tr><tr><td>实时通信、高频事件</td><td>✅ <code>send</code> + <code>on</code>（避免 Promise 开销）</td></tr></tbody></table><h3 id="零碎" tabindex="-1"><a class="header-anchor" href="#零碎"><span>零碎</span></a></h3><h4 id="放入托盘-右下角" tabindex="-1"><a class="header-anchor" href="#放入托盘-右下角"><span>放入托盘（右下角）</span></a></h4><h4 id="窗口事件" tabindex="-1"><a class="header-anchor" href="#窗口事件"><span>窗口事件</span></a></h4><h4 id="store本地缓存" tabindex="-1"><a class="header-anchor" href="#store本地缓存"><span>Store本地缓存</span></a></h4><p>这个缓存能够在关闭进程后依旧记录导入的信息，可以以键值对的形式实现对关键数据的存储：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">const</span> Store <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;electron-store&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> store <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Store</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> userId <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">initUserId</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">_userId</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    userId <span class="token operator">=</span> _userId<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">getUserId</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> userId<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">setData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    store<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">getData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> store<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 键值对形式存储</span></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">setUserData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">setData</span><span class="token punctuation">(</span>userId <span class="token operator">+</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">getUserData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token function">getData</span><span class="token punctuation">(</span>userId <span class="token operator">+</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">const</span> <span class="token function-variable function">deleteUserData</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    store<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>userId <span class="token operator">+</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span></span>
<span class="line">    initUserId<span class="token punctuation">,</span></span>
<span class="line">    getUserId<span class="token punctuation">,</span></span>
<span class="line">    setData<span class="token punctuation">,</span></span>
<span class="line">    getData<span class="token punctuation">,</span></span>
<span class="line">    setUserData<span class="token punctuation">,</span></span>
<span class="line">    getUserData<span class="token punctuation">,</span></span>
<span class="line">    deleteUserData</span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="pinia的缓存" tabindex="-1"><a class="header-anchor" href="#pinia的缓存"><span>pinia的缓存</span></a></h4><p>pinia提供了一套非常好用的vue的工具，有和store效果相近的store可供选择：</p><p><strong>pinia能够实现关闭页面后的数据缓存</strong>，因为：</p><ul><li>利用了浏览器的 <code>localStorage</code> API</li><li>localStorage 是持久性存储，除非用户手动清除或程序主动删除</li><li>页面重新加载时可以从 localStorage 恢复数据到 Pinia store</li></ul><p>由于项目选择的是eletron，他的内核就是一个谷歌浏览器，所以pinia提供的store也是可以直接使用的。但注意，这一部分是vue特供的，所以需要在renderer渲染器中使用！</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> defineStore <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;pinia&quot;</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> useUserInfoStore <span class="token operator">=</span> <span class="token function">defineStore</span><span class="token punctuation">(</span><span class="token string">&#39;userInfo&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function-variable function">state</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">userInfo</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token literal-property property">actions</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token function">setInfo</span><span class="token punctuation">(</span><span class="token parameter">userInfo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">this</span><span class="token punctuation">.</span>userInfo <span class="token operator">=</span> userInfo<span class="token punctuation">;</span></span>
<span class="line">      localStorage<span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token string">&quot;userInfo&quot;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userInfo<span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意和eletron的store区分，一个是主线程的，一个是渲染器线程的。</p>`,24)])])}const i=s(p,[["render",o]]),r=JSON.parse('{"path":"/docs/wx/qianduanbufen/Eletronsuji.html","title":"Eletron速记","lang":"en-US","frontmatter":{"title":"Eletron速记","date":"2025/11/3","tags":["笔记","前端","Eletron"],"categories":["notes"]},"headers":[{"level":3,"title":"渲染线程vue与主线程","slug":"渲染线程vue与主线程","link":"#渲染线程vue与主线程","children":[]},{"level":3,"title":"零碎","slug":"零碎","link":"#零碎","children":[]}],"git":{"createdTime":1762180635000,"updatedTime":1762180635000,"contributors":[{"name":"SaltFishGC","email":"130335482+SaltFishGC@users.noreply.github.com","commits":1}]},"filePathRelative":"docs/wx/前端部分/Eletron速记.md"}');export{i as comp,r as data};
