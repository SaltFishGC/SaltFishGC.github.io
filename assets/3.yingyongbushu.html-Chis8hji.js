import{ar as s,as as a,ax as e,at as l}from"./app-DXmPnZac.js";const t={};function i(p,n){return l(),a("div",null,[...n[0]||(n[0]=[e(`<h2 id="åç«¯é¡¹ç›®éƒ¨ç½²" tabindex="-1"><a class="header-anchor" href="#åç«¯é¡¹ç›®éƒ¨ç½²"><span>åç«¯é¡¹ç›®éƒ¨ç½²</span></a></h2><h3 id="packageå¾—åˆ°jaråŒ…" tabindex="-1"><a class="header-anchor" href="#packageå¾—åˆ°jaråŒ…"><span>packageå¾—åˆ°jaråŒ…</span></a></h3><p>å¦‚æœæˆ‘ä»¬ä½¿ç”¨jaråŒ…å®ç°åç«¯é¡¹ç›®éƒ¨ç½²ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆå°†é¡¹ç›®ä½¿ç”¨ideaç­‰å®Œæˆé¡¹ç›®çš„æ‰“åŒ…ï¼Œæœ€ç»ˆå¾—åˆ°æ–‡ä»¶ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">my-java-app/</span>
<span class="line">â”œâ”€â”€ app.jar          <span class="token comment"># å·²ç¼–è¯‘å¥½çš„å¯æ‰§è¡Œ JAR</span></span>
<span class="line">â””â”€â”€ Dockerfile</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¼–å†™dockerfile" tabindex="-1"><a class="header-anchor" href="#ç¼–å†™dockerfile"><span>ç¼–å†™Dockerfile</span></a></h3><p>ç„¶åå®Œæˆå¯¹åº”é¡¹ç›®çš„<code>Dockerfile</code>æ–‡ä»¶ç¼–å†™ï¼š</p><div class="language-docker line-numbers-mode" data-highlighter="prismjs" data-ext="docker" data-title="docker"><pre><code><span class="line"><span class="token comment"># ä½¿ç”¨å®˜æ–¹è½»é‡çº§ JRE é•œåƒï¼ˆæ¨è Temurinï¼‰</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">FROM</span> eclipse-temurin:17-jre-alpine</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ›å»ºå·¥ä½œç›®å½•</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¤åˆ¶ JAR æ–‡ä»¶</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> app.jar app.jar</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æš´éœ²ç«¯å£ï¼ˆæ ¹æ®åº”ç”¨å®é™…ç«¯å£è°ƒæ•´ï¼‰</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">EXPOSE</span> 8080</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¯åŠ¨å‘½ä»¤</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">&quot;java&quot;</span>, <span class="token string">&quot;-jar&quot;</span>, <span class="token string">&quot;app.jar&quot;</span>]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ğŸ”‘ <strong>å…³é”®ç‚¹</strong>ï¼š</p><ul><li><code>eclipse-temurin:17-jre-alpine</code>ï¼šä»…å« JREï¼Œä½“ç§¯çº¦ <strong>ï½150MB</strong></li><li>é¿å…ä½¿ç”¨ <code>openjdk:17</code>ï¼ˆé»˜è®¤æ˜¯ JDKï¼Œä½“ç§¯ ï½500MB+ï¼‰</li><li>Alpine ç‰ˆæœ¬æ›´å°ï¼Œä½†æ³¨æ„ glibc å…¼å®¹æ€§é—®é¢˜ï¼ˆä¸€èˆ¬ Java åº”ç”¨æ— å½±å“ï¼‰</li></ul></blockquote><h3 id="buildåˆ›å»ºè‡ªåˆ¶é•œåƒ" tabindex="-1"><a class="header-anchor" href="#buildåˆ›å»ºè‡ªåˆ¶é•œåƒ"><span>buildåˆ›å»ºè‡ªåˆ¶é•œåƒ</span></a></h3><p>ç„¶åä½¿ç”¨buildå‘½ä»¤å®Œæˆé•œåƒçš„è‡ªå®šä¹‰ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">docker</span> build <span class="token parameter variable">-t</span> é•œåƒå:æ ‡ç­¾ æ„å»ºä¸Šä¸‹æ–‡è·¯å¾„</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>é»˜è®¤<code>Dockerfile</code>åœ¨ä¸Šä¸‹æ–‡è·¯å¾„ä¸‹ï¼ˆæ³¨æ„åç§°å¿…é¡»ä¸º<code>Dockerfile</code>ï¼Œä¸å¯æ›´æ”¹ï¼‰ä¸åœ¨ä¸Šä¸‹æ–‡è·¯å¾„ä¸‹åˆ™éœ€è¦åŠ <code>-f</code>æŒ‡å®šæ–‡ä»¶<code>Dockerfile.prod</code>è·¯å¾„</p></blockquote><h3 id="runè¿è¡Œè‡ªåˆ¶é•œåƒ" tabindex="-1"><a class="header-anchor" href="#runè¿è¡Œè‡ªåˆ¶é•œåƒ"><span>runè¿è¡Œè‡ªåˆ¶é•œåƒ</span></a></h3><p>ç„¶åå°±å®Œæˆäº†é•œåƒçš„åˆ¶ä½œäº†ï¼Œæ¥ç€å°±å¯ä»¥ç›´æ¥<code>docker run</code>è‡ªåˆ¶çš„é•œåƒäº†ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ é•œåƒå:æ ‡ç­¾</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å…¶ä¸­æŒ‡å®šå¥½ç½‘ç»œä»¥åŠæŒ‚è½½æ–‡ä»¶ã€‚</p><h2 id="å‰ç«¯é¡¹ç›®éƒ¨ç½²" tabindex="-1"><a class="header-anchor" href="#å‰ç«¯é¡¹ç›®éƒ¨ç½²"><span>å‰ç«¯é¡¹ç›®éƒ¨ç½²</span></a></h2><p>å¦‚æœç›´æ¥ç”¨nginxä½œä¸ºå‰ç«¯ï¼Œé‚£å½“ç„¶å¯ä»¥ç›´æ¥ç”¨å®˜æ–¹çš„nginxé•œåƒæä¸ªå®¹å™¨ï¼Œå°†æ–‡ä»¶å¤¹ç›´æ¥æŒ‚è½½åˆ°ä¸»æœºï¼Œç„¶ååœ¨ä¸»æœºæ”¹æ”¹å°±è¡Œã€‚</p><h3 id="ğŸ“-é¡¹ç›®ç»“æ„å‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#ğŸ“-é¡¹ç›®ç»“æ„å‡†å¤‡"><span><strong>ğŸ“ é¡¹ç›®ç»“æ„å‡†å¤‡</strong></span></a></h3><p>ç¡®ä¿ä½ çš„ Vue é¡¹ç›®å·²é€šè¿‡ <code>npm run build</code> ç”Ÿæˆ <code>dist/</code> ç›®å½•ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line">my-vue-app/</span>
<span class="line">â”œâ”€â”€ src/               <span class="token comment"># æºç </span></span>
<span class="line">â”œâ”€â”€ public/            <span class="token comment"># é™æ€èµ„æº</span></span>
<span class="line">â”œâ”€â”€ package.json</span>
<span class="line">â”œâ”€â”€ vue.config.js      <span class="token comment"># ï¼ˆå¯é€‰ï¼‰é…ç½®</span></span>
<span class="line">â”œâ”€â”€ dist/              <span class="token comment"># â† å¿…é¡»å­˜åœ¨ï¼ç”± npm run build ç”Ÿæˆ</span></span>
<span class="line">â””â”€â”€ Dockerfile         <span class="token comment"># â† å¾…åˆ›å»º</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ğŸ”§ å¦‚æœæ²¡æœ‰ <code>dist/</code>ï¼Œå…ˆæœ¬åœ°æ„å»ºï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">npm</span> <span class="token function">install</span></span>
<span class="line"><span class="token function">npm</span> run build   <span class="token comment"># ç”Ÿæˆ dist/ ç›®å½•</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><hr><h3 id="ğŸ³-dockerfile-å¤šé˜¶æ®µæ„å»º-ç”Ÿäº§çº§" tabindex="-1"><a class="header-anchor" href="#ğŸ³-dockerfile-å¤šé˜¶æ®µæ„å»º-ç”Ÿäº§çº§"><span><strong>ğŸ³ Dockerfileï¼ˆå¤šé˜¶æ®µæ„å»º - ç”Ÿäº§çº§ï¼‰</strong></span></a></h3><div class="language-docker line-numbers-mode" data-highlighter="prismjs" data-ext="docker" data-title="docker"><pre><code><span class="line"><span class="token comment"># ===== ç¬¬ä¸€é˜¶æ®µï¼šæ„å»ºé™æ€æ–‡ä»¶ =====</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">FROM</span> node:18-alpine <span class="token keyword">AS</span> builder</span></span>
<span class="line"></span>
<span class="line"><span class="token instruction"><span class="token keyword">WORKDIR</span> /app</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¤åˆ¶ä¾èµ–é…ç½®ï¼ˆåˆ©ç”¨å±‚ç¼“å­˜ï¼‰</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> package*.json ./</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å®‰è£…ä¾èµ–ï¼ˆä½¿ç”¨å›½å†…æºåŠ é€Ÿï¼‰</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">RUN</span> npm install --registry https://registry.npmmirror.com</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¤åˆ¶æºç </span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> . .</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æ„å»ºç”Ÿäº§ç‰ˆæœ¬ï¼ˆç”Ÿæˆ dist/ï¼‰</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">RUN</span> npm run build</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ===== ç¬¬äºŒé˜¶æ®µï¼šNginx æ‰˜ç®¡ =====</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">FROM</span> nginx:alpine</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># åˆ é™¤é»˜è®¤é…ç½®</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">RUN</span> rm -rf /usr/share/nginx/html/*</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># ä» builder é˜¶æ®µå¤åˆ¶é™æ€æ–‡ä»¶</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> <span class="token options"><span class="token property">--from</span><span class="token punctuation">=</span><span class="token string">builder</span></span> /app/dist /usr/share/nginx/html</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># å¤åˆ¶è‡ªå®šä¹‰ Nginx é…ç½®ï¼ˆå¯é€‰ï¼‰</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">COPY</span> nginx.conf /etc/nginx/conf.d/default.conf</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># æš´éœ² 80 ç«¯å£</span></span>
<span class="line"><span class="token instruction"><span class="token keyword">EXPOSE</span> 80</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Nginx é»˜è®¤å¯åŠ¨å‘½ä»¤å·²å†…ç½®ï¼Œæ— éœ€ CMD</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ğŸ’¡ <strong>å…³é”®ç‚¹</strong>ï¼š</p><ul><li>ä½¿ç”¨ <code>node:18-alpine</code> æ„å»ºï¼ˆä½“ç§¯å°ï¼‰</li><li>ä½¿ç”¨ <code>nginx:alpine</code> è¿è¡Œï¼ˆä»… ï½23MBï¼‰</li><li><strong>æœ€ç»ˆé•œåƒä¸å« Node.jsã€npmã€æºç </strong></li></ul></blockquote><hr><h3 id="âš™ï¸-å¯é€‰-è‡ªå®šä¹‰-nginx-é…ç½®-nginx-conf" tabindex="-1"><a class="header-anchor" href="#âš™ï¸-å¯é€‰-è‡ªå®šä¹‰-nginx-é…ç½®-nginx-conf"><span><strong>âš™ï¸ å¯é€‰ï¼šè‡ªå®šä¹‰ Nginx é…ç½®ï¼ˆ</strong><code>nginx.conf</code><strong>ï¼‰</strong></span></a></h3><p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º <code>nginx.conf</code>ï¼Œè§£å†³ Vue Router <strong>history æ¨¡å¼ 404 é—®é¢˜</strong>ï¼š</p><div class="language-nginx line-numbers-mode" data-highlighter="prismjs" data-ext="nginx" data-title="nginx"><pre><code><span class="line"><span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">listen</span> <span class="token number">80</span></span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">server_name</span> localhost</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">    <span class="token directive"><span class="token keyword">location</span> /</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token directive"><span class="token keyword">root</span> /usr/share/nginx/html</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token directive"><span class="token keyword">index</span> index.html index.htm</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment"># å…³é”®ï¼šæ‰€æœ‰è·¯ç”± fallback åˆ° index.html</span></span>
<span class="line">        <span class="token directive"><span class="token keyword">try_files</span> <span class="token variable">$uri</span> <span class="token variable">$uri</span>/ /index.html</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># gzip å‹ç¼©ï¼ˆæå‡åŠ è½½é€Ÿåº¦ï¼‰</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">gzip</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">gzip_vary</span> <span class="token boolean">on</span></span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">gzip_min_length</span> <span class="token number">1024</span></span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token directive"><span class="token keyword">gzip_types</span> text/plain text/css application/json application/javascript text/xml application/xml</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>âœ… å¦‚æœä½ ç”¨çš„æ˜¯ <strong>hash æ¨¡å¼</strong>ï¼ˆURL å« <code>#</code>ï¼‰ï¼Œå¯çœç•¥æ­¤æ–‡ä»¶ã€‚</p></blockquote><hr><h3 id="ğŸ› ï¸-æ„å»º-è¿è¡Œå‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#ğŸ› ï¸-æ„å»º-è¿è¡Œå‘½ä»¤"><span><strong>ğŸ› ï¸ æ„å»º &amp; è¿è¡Œå‘½ä»¤</strong></span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 1. æ„å»ºé•œåƒ</span></span>
<span class="line"><span class="token function">docker</span> build <span class="token parameter variable">-t</span> my-vue-app <span class="token builtin class-name">.</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 2. è¿è¡Œå®¹å™¨ï¼ˆæ˜ å°„ 80 ç«¯å£ï¼‰</span></span>
<span class="line"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">80</span>:80 <span class="token parameter variable">--name</span> vue-web my-vue-app</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 3. è®¿é—®åº”ç”¨</span></span>
<span class="line"><span class="token function">open</span> http://localhost</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>ğŸ” éªŒè¯ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">curl</span> http://localhost <span class="token operator">|</span> <span class="token function">head</span> <span class="token parameter variable">-n</span> <span class="token number">5</span>  <span class="token comment"># åº”è¿”å› HTML å†…å®¹</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></blockquote><hr><h3 id="ğŸŒ-éƒ¨ç½²åˆ°æœåŠ¡å™¨-å¸¦åŸŸå" tabindex="-1"><a class="header-anchor" href="#ğŸŒ-éƒ¨ç½²åˆ°æœåŠ¡å™¨-å¸¦åŸŸå"><span><strong>ğŸŒ éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼ˆå¸¦åŸŸåï¼‰</strong></span></a></h3><p>å‡è®¾ä½ æœ‰åŸŸå <code>example.com</code>ï¼Œé…åˆ Nginx åå‘ä»£ç†æˆ–ç›´æ¥ä½¿ç”¨ï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œï¼ˆç›‘å¬ 80 ç«¯å£ï¼‰</span></span>
<span class="line"><span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token number">80</span>:80 <span class="token parameter variable">--restart</span> unless-stopped my-vue-app</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>ç„¶åå°† DNS è§£ææŒ‡å‘æœåŠ¡å™¨ IP å³å¯ã€‚</p><blockquote><p>å‡ ä¸ªå‘½ä»¤æ‰§è¡ŒæŒ‡ä»¤çš„åŒºåˆ«ï¼š</p><table><thead><tr><th style="text-align:left;">æŒ‡ä»¤</th><th style="text-align:left;">æ‰§è¡Œæ—¶æœº</th><th style="text-align:left;">ä½œç”¨</th><th style="text-align:left;">æ˜¯å¦å‡ºç°åœ¨æœ€ç»ˆå®¹å™¨ä¸­</th><th style="text-align:left;">èƒ½å¦è¢«<code>docker run</code>è¦†ç›–</th></tr></thead><tbody><tr><td style="text-align:left;"><strong><code>RUN</code></strong></td><td style="text-align:left;"><strong>é•œåƒæ„å»ºæ—¶</strong>ï¼ˆ<code>docker build</code>ï¼‰</td><td style="text-align:left;">å®‰è£…è½¯ä»¶ã€ç¼–è¯‘ä»£ç ã€ç”Ÿæˆæ–‡ä»¶ç­‰</td><td style="text-align:left;">âŒ ä¸è¿è¡Œï¼Œåªç•™ä¸‹ç»“æœï¼ˆå¦‚å®‰è£…çš„åŒ…ã€ç”Ÿæˆçš„æ–‡ä»¶ï¼‰</td><td style="text-align:left;">âŒ ä¸èƒ½è¦†ç›–ï¼ˆå·²å›ºåŒ–åœ¨é•œåƒå±‚ä¸­ï¼‰</td></tr><tr><td style="text-align:left;"><strong><code>CMD</code></strong></td><td style="text-align:left;"><strong>å®¹å™¨å¯åŠ¨æ—¶</strong>ï¼ˆ<code>docker run</code>ï¼‰</td><td style="text-align:left;">æä¾›é»˜è®¤çš„å¯åŠ¨å‘½ä»¤å’Œå‚æ•°</td><td style="text-align:left;">âœ… æ˜¯å®¹å™¨çš„ä¸»è¿›ç¨‹</td><td style="text-align:left;">âœ… <strong>å¯ä»¥è¢« <code>docker run</code> åçš„å‘½ä»¤å®Œå…¨è¦†ç›–</strong></td></tr><tr><td style="text-align:left;"><strong><code>ENTRYPOINT</code></strong></td><td style="text-align:left;"><strong>å®¹å™¨å¯åŠ¨æ—¶</strong>ï¼ˆ<code>docker run</code>ï¼‰</td><td style="text-align:left;">å®šä¹‰å®¹å™¨çš„â€œä¸»ç¨‹åºâ€</td><td style="text-align:left;">âœ… æ˜¯å®¹å™¨çš„ä¸»è¿›ç¨‹</td><td style="text-align:left;">âš ï¸ <strong>ä¸æ˜“è¢«è¦†ç›–</strong>ï¼š â€¢ <code>docker run image arg1 arg2</code> â†’ å‚æ•°ä¼šä¼ ç»™ <code>ENTRYPOINT</code> â€¢ åªæœ‰ <code>--entrypoint</code> èƒ½æ›¿æ¢å®ƒ</td></tr></tbody></table></blockquote><h2 id="dockercompose" tabindex="-1"><a class="header-anchor" href="#dockercompose"><span>DockerCompose</span></a></h2><p><strong>Docker Compose</strong> æ˜¯ Docker å®˜æ–¹æä¾›çš„ä¸€ä¸ª<strong>å¤šå®¹å™¨åº”ç”¨ç¼–æ’å·¥å…·</strong>ï¼Œå®ƒå…è®¸ä½ é€šè¿‡ä¸€ä¸ª <strong>YAML é…ç½®æ–‡ä»¶ï¼ˆ<code>docker-compose.yml</code>ï¼‰</strong> æ¥å®šä¹‰å’Œè¿è¡Œå¤šä¸ªç›¸äº’å…³è”çš„å®¹å™¨æœåŠ¡ã€‚</p><blockquote><p>ğŸ’¡ <strong>æ ¸å¿ƒä»·å€¼</strong>ï¼š <strong>â€œä¸€é”®å¯åŠ¨æ•´ä¸ªåº”ç”¨æ ˆâ€</strong> â€”â€” æ— éœ€æ‰‹åŠ¨é€ä¸ªè¿è¡Œ <code>docker run</code> å‘½ä»¤ã€‚</p></blockquote><table><thead><tr><th style="text-align:left;">æ¦‚å¿µ</th><th style="text-align:left;">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>Serviceï¼ˆæœåŠ¡ï¼‰</strong></td><td style="text-align:left;">ä¸€ä¸ªåº”ç”¨ç»„ä»¶ï¼ˆå¦‚ <code>web</code>ã€<code>db</code>ï¼‰ï¼Œå¯¹åº”ä¸€ä¸ªå®¹å™¨é•œåƒ</td></tr><tr><td style="text-align:left;"><strong>Projectï¼ˆé¡¹ç›®ï¼‰</strong></td><td style="text-align:left;">ç”± <code>docker-compose.yml</code> å®šä¹‰çš„ä¸€ç»„æœåŠ¡ï¼Œé»˜è®¤ä»¥ç›®å½•åä½œä¸ºé¡¹ç›®å</td></tr><tr><td style="text-align:left;"><strong>Volumeï¼ˆå·ï¼‰</strong></td><td style="text-align:left;">æŒä¹…åŒ–æ•°æ®ï¼ˆå¦‚æ•°æ®åº“æ–‡ä»¶ï¼‰</td></tr><tr><td style="text-align:left;"><strong>Networkï¼ˆç½‘ç»œï¼‰</strong></td><td style="text-align:left;">æœåŠ¡é—´é€šä¿¡çš„ç§æœ‰ç½‘ç»œï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰</td></tr></tbody></table><h3 id="ymlæ–‡ä»¶å†…å®¹" tabindex="-1"><a class="header-anchor" href="#ymlæ–‡ä»¶å†…å®¹"><span>ymlæ–‡ä»¶å†…å®¹</span></a></h3><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&#39;3.8&#39;</span>          <span class="token comment"># Compose æ–‡ä»¶ç‰ˆæœ¬ï¼ˆæ¨è 3.xï¼‰</span></span>
<span class="line"></span>
<span class="line"><span class="token key atrule">services</span><span class="token punctuation">:</span>               <span class="token comment"># å®šä¹‰æ‰€æœ‰æœåŠ¡</span></span>
<span class="line">  <span class="token key atrule">web</span><span class="token punctuation">:</span>                  <span class="token comment"># æœåŠ¡åï¼ˆå¯è‡ªå®šä¹‰ï¼‰</span></span>
<span class="line">    <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx<span class="token punctuation">:</span>alpine</span>
<span class="line">    <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token string">&quot;80:80&quot;</span></span>
<span class="line">    <span class="token key atrule">volumes</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> ./html<span class="token punctuation">:</span>/usr/share/nginx/html</span>
<span class="line">    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> app</span>
<span class="line"></span>
<span class="line">  <span class="token key atrule">app</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">build</span><span class="token punctuation">:</span> .            <span class="token comment"># ä»å½“å‰ç›®å½• Dockerfile æ„å»º</span></span>
<span class="line">    <span class="token key atrule">ports</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token string">&quot;8080:8080&quot;</span></span>
<span class="line">    <span class="token key atrule">environment</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> DB_HOST=db</span>
<span class="line">    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>			<span class="token comment"># ä¾èµ–dbé•œåƒï¼Œä¼šå…ˆåˆ›å»ºdbé•œåƒå†æä»–</span></span>
<span class="line">      <span class="token punctuation">-</span> db</span>
<span class="line"></span>
<span class="line">  <span class="token key atrule">db</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span><span class="token number">8.0</span></span>
<span class="line">    <span class="token key atrule">environment</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token key atrule">MYSQL_ROOT_PASSWORD</span><span class="token punctuation">:</span> root123</span>
<span class="line">      <span class="token key atrule">MYSQL_DATABASE</span><span class="token punctuation">:</span> myapp</span>
<span class="line">    <span class="token key atrule">volumes</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> db_data<span class="token punctuation">:</span>/var/lib/mysql</span>
<span class="line"></span>
<span class="line"><span class="token key atrule">volumes</span><span class="token punctuation">:</span>                <span class="token comment"># å®šä¹‰å‘½åå·</span></span>
<span class="line">  <span class="token key atrule">db_data</span><span class="token punctuation">:</span></span>
<span class="line"></span>
<span class="line"><span class="token key atrule">networks</span><span class="token punctuation">:</span>               <span class="token comment"># ï¼ˆå¯é€‰ï¼‰è‡ªå®šä¹‰ç½‘ç»œ</span></span>
<span class="line">  <span class="token key atrule">default</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">driver</span><span class="token punctuation">:</span> bridge</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th style="text-align:left;">å­—æ®µ</th><th style="text-align:left;">ä½œç”¨</th><th style="text-align:left;">ç¤ºä¾‹</th></tr></thead><tbody><tr><td style="text-align:left;"><code>image</code></td><td style="text-align:left;">ç›´æ¥ä½¿ç”¨é•œåƒä»“åº“ä¸­çš„é•œåƒ</td><td style="text-align:left;"><code>image: redis:7-alpine</code></td></tr><tr><td style="text-align:left;"><code>build</code></td><td style="text-align:left;">ä»æœ¬åœ° Dockerfile æ„å»º</td><td style="text-align:left;"><code>build: ./my-app</code> æˆ– <code>build: { context: ., dockerfile: Dockerfile.prod }</code></td></tr></tbody></table><blockquote><p>âœ… <strong>å»ºè®®</strong>ï¼šå¼€å‘ç”¨ <code>build</code>ï¼Œç”Ÿäº§ç”¨ <code>image</code>ï¼ˆæå‰æ„å»ºå¥½æ¨é€åˆ°ä»“åº“ï¼‰</p></blockquote><blockquote><p>âš ï¸ æ³¨æ„ï¼š<code>depends_on</code> <strong>åªæ§åˆ¶å¯åŠ¨é¡ºåºï¼Œä¸ç­‰å¾…æœåŠ¡å°±ç»ª</strong>ï¼ å¦‚éœ€ç­‰å¾… DB å°±ç»ªï¼Œéœ€é…åˆ <code>healthcheck</code> æˆ–è„šæœ¬ã€‚</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre><code><span class="line"><span class="token key atrule">healthcheck</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">test</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">&quot;CMD&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;curl&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;-f&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;http://localhost:8080/health&quot;</span><span class="token punctuation">]</span></span>
<span class="line">  <span class="token key atrule">interval</span><span class="token punctuation">:</span> 30s</span>
<span class="line">  <span class="token key atrule">timeout</span><span class="token punctuation">:</span> 10s</span>
<span class="line">  <span class="token key atrule">retries</span><span class="token punctuation">:</span> <span class="token number">3</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>âœ… é…åˆ <code>depends_on</code> å®ç°â€œçœŸæ­£ç­‰å¾…æœåŠ¡å°±ç»ªâ€</p></blockquote><h3 id="å¸¸ç”¨å‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#å¸¸ç”¨å‘½ä»¤"><span>å¸¸ç”¨å‘½ä»¤</span></a></h3><table><thead><tr><th style="text-align:left;">å‘½ä»¤</th><th style="text-align:left;">ä½œç”¨</th></tr></thead><tbody><tr><td style="text-align:left;"><code>docker compose up</code></td><td style="text-align:left;">å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆå‰å°è¿è¡Œï¼‰</td></tr><tr><td style="text-align:left;"><code>docker compose up -d</code></td><td style="text-align:left;">åå°å¯åŠ¨ï¼ˆå®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ï¼‰</td></tr><tr><td style="text-align:left;"><code>docker compose down</code></td><td style="text-align:left;">åœæ­¢å¹¶åˆ é™¤å®¹å™¨ã€ç½‘ç»œï¼ˆ<strong>ä¸åˆ å·</strong>ï¼‰</td></tr><tr><td style="text-align:left;"><code>docker compose logs -f web</code></td><td style="text-align:left;">æŸ¥çœ‹ <code>web</code> æœåŠ¡æ—¥å¿—</td></tr><tr><td style="text-align:left;"><code>docker compose ps</code></td><td style="text-align:left;">åˆ—å‡ºé¡¹ç›®ä¸­æ‰€æœ‰å®¹å™¨çŠ¶æ€</td></tr><tr><td style="text-align:left;"><code>docker compose build</code></td><td style="text-align:left;">é‡æ–°æ„å»º <code>build</code> ç±»å‹çš„æœåŠ¡</td></tr><tr><td style="text-align:left;"><code>docker compose restart db</code></td><td style="text-align:left;">é‡å¯ <code>db</code> æœåŠ¡</td></tr></tbody></table><h3 id="å’Œk8sçš„æ¯”è¾ƒ" tabindex="-1"><a class="header-anchor" href="#å’Œk8sçš„æ¯”è¾ƒ"><span>å’Œk8sçš„æ¯”è¾ƒ</span></a></h3><table><thead><tr><th style="text-align:left;">ç‰¹æ€§</th><th style="text-align:left;">Docker Compose</th><th style="text-align:left;">Kubernetes</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>å®šä½</strong></td><td style="text-align:left;">å•æœºå¤šå®¹å™¨ç¼–æ’</td><td style="text-align:left;">åˆ†å¸ƒå¼é›†ç¾¤ç¼–æ’</td></tr><tr><td style="text-align:left;"><strong>å­¦ä¹ æ›²çº¿</strong></td><td style="text-align:left;">ç®€å•ï¼ˆYAML + å‡ ä¸ªå‘½ä»¤ï¼‰</td><td style="text-align:left;">å¤æ‚</td></tr><tr><td style="text-align:left;"><strong>é€‚ç”¨åœºæ™¯</strong></td><td style="text-align:left;">å¼€å‘ã€æµ‹è¯•ã€å°å‹ç”Ÿäº§</td><td style="text-align:left;">ä¸­å¤§å‹ç”Ÿäº§ç¯å¢ƒ</td></tr><tr><td style="text-align:left;"><strong>é«˜å¯ç”¨/æ‰©ç¼©å®¹</strong></td><td style="text-align:left;">ä¸æ”¯æŒ</td><td style="text-align:left;">åŸç”Ÿæ”¯æŒ</td></tr></tbody></table>`,54)])])}const o=s(t,[["render",i]]),d=JSON.parse('{"path":"/docs/heimashangcheng/Docker/3.yingyongbushu.html","title":"åº”ç”¨éƒ¨ç½²","lang":"en-US","frontmatter":{"title":"åº”ç”¨éƒ¨ç½²","date":"2026-1-31"},"headers":[{"level":2,"title":"åç«¯é¡¹ç›®éƒ¨ç½²","slug":"åç«¯é¡¹ç›®éƒ¨ç½²","link":"#åç«¯é¡¹ç›®éƒ¨ç½²","children":[{"level":3,"title":"packageå¾—åˆ°jaråŒ…","slug":"packageå¾—åˆ°jaråŒ…","link":"#packageå¾—åˆ°jaråŒ…","children":[]},{"level":3,"title":"ç¼–å†™Dockerfile","slug":"ç¼–å†™dockerfile","link":"#ç¼–å†™dockerfile","children":[]},{"level":3,"title":"buildåˆ›å»ºè‡ªåˆ¶é•œåƒ","slug":"buildåˆ›å»ºè‡ªåˆ¶é•œåƒ","link":"#buildåˆ›å»ºè‡ªåˆ¶é•œåƒ","children":[]},{"level":3,"title":"runè¿è¡Œè‡ªåˆ¶é•œåƒ","slug":"runè¿è¡Œè‡ªåˆ¶é•œåƒ","link":"#runè¿è¡Œè‡ªåˆ¶é•œåƒ","children":[]}]},{"level":2,"title":"å‰ç«¯é¡¹ç›®éƒ¨ç½²","slug":"å‰ç«¯é¡¹ç›®éƒ¨ç½²","link":"#å‰ç«¯é¡¹ç›®éƒ¨ç½²","children":[{"level":3,"title":"ğŸ“ é¡¹ç›®ç»“æ„å‡†å¤‡","slug":"ğŸ“-é¡¹ç›®ç»“æ„å‡†å¤‡","link":"#ğŸ“-é¡¹ç›®ç»“æ„å‡†å¤‡","children":[]},{"level":3,"title":"ğŸ³ Dockerfileï¼ˆå¤šé˜¶æ®µæ„å»º - ç”Ÿäº§çº§ï¼‰","slug":"ğŸ³-dockerfile-å¤šé˜¶æ®µæ„å»º-ç”Ÿäº§çº§","link":"#ğŸ³-dockerfile-å¤šé˜¶æ®µæ„å»º-ç”Ÿäº§çº§","children":[]},{"level":3,"title":"âš™ï¸ å¯é€‰ï¼šè‡ªå®šä¹‰ Nginx é…ç½®ï¼ˆnginx.confï¼‰","slug":"âš™ï¸-å¯é€‰-è‡ªå®šä¹‰-nginx-é…ç½®-nginx-conf","link":"#âš™ï¸-å¯é€‰-è‡ªå®šä¹‰-nginx-é…ç½®-nginx-conf","children":[]},{"level":3,"title":"ğŸ› ï¸ æ„å»º & è¿è¡Œå‘½ä»¤","slug":"ğŸ› ï¸-æ„å»º-è¿è¡Œå‘½ä»¤","link":"#ğŸ› ï¸-æ„å»º-è¿è¡Œå‘½ä»¤","children":[]},{"level":3,"title":"ğŸŒ éƒ¨ç½²åˆ°æœåŠ¡å™¨ï¼ˆå¸¦åŸŸåï¼‰","slug":"ğŸŒ-éƒ¨ç½²åˆ°æœåŠ¡å™¨-å¸¦åŸŸå","link":"#ğŸŒ-éƒ¨ç½²åˆ°æœåŠ¡å™¨-å¸¦åŸŸå","children":[]}]},{"level":2,"title":"DockerCompose","slug":"dockercompose","link":"#dockercompose","children":[{"level":3,"title":"ymlæ–‡ä»¶å†…å®¹","slug":"ymlæ–‡ä»¶å†…å®¹","link":"#ymlæ–‡ä»¶å†…å®¹","children":[]},{"level":3,"title":"å¸¸ç”¨å‘½ä»¤","slug":"å¸¸ç”¨å‘½ä»¤","link":"#å¸¸ç”¨å‘½ä»¤","children":[]},{"level":3,"title":"å’Œk8sçš„æ¯”è¾ƒ","slug":"å’Œk8sçš„æ¯”è¾ƒ","link":"#å’Œk8sçš„æ¯”è¾ƒ","children":[]}]}],"git":{"createdTime":1771338216000,"updatedTime":1771338216000,"contributors":[{"name":"SaltFishGC","email":"130335482+SaltFishGC@users.noreply.github.com","commits":1}]},"filePathRelative":"docs/é»‘é©¬å•†åŸ/Docker/3.åº”ç”¨éƒ¨ç½².md"}');export{o as comp,d as data};
