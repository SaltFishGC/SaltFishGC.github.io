import{_ as s,c as a,e as t,o as e}from"./app-DI6YVXtA.js";const p={};function o(l,n){return e(),a("div",null,[...n[0]||(n[0]=[t(`<h3 id="geoæ•°æ®ç»“æ„" tabindex="-1"><a class="header-anchor" href="#geoæ•°æ®ç»“æ„"><span>GEOæ•°æ®ç»“æ„</span></a></h3><p>é™¤äº†å…ˆå‰çš„ä¸€äº›åŸºæœ¬æ•°æ®ç±»å‹ï¼ŒRediså¼•å…¥äº†ä¸€äº›é¢å¤–çš„æ•°æ®ç±»å‹ï¼Œåœ°ç†åæ ‡geoå°±åœ¨å…¶ä¸­ï¼š</p><ul><li>Redis ä½¿ç”¨ Sorted Set å­˜å‚¨åœ°ç†ä½ç½®ï¼š <ul><li><strong>æˆå‘˜ï¼ˆmemberï¼‰</strong>ï¼šä½ç½®åç§°ï¼ˆå¦‚ <code>&quot;user:123&quot;</code>ã€<code>&quot;shop:beijing&quot;</code>ï¼‰</li><li><strong>score</strong>ï¼šè¯¥ä½ç½®çš„ <strong>52 ä½æ•´æ•°ç¼–ç </strong>ï¼ˆé€šè¿‡ <strong>GeoHash ç®—æ³•</strong> å°†ç»çº¬åº¦è½¬æ¢è€Œæ¥ï¼‰</li></ul></li></ul><table><thead><tr><th style="text-align:left;">å‘½ä»¤</th><th style="text-align:left;">åŠŸèƒ½</th><th style="text-align:left;">è¯­æ³•</th><th style="text-align:left;">å…¸å‹å‚æ•°/é€‰é¡¹</th><th style="text-align:left;">è¿”å›å€¼</th><th style="text-align:left;">æ³¨æ„äº‹é¡¹</th></tr></thead><tbody><tr><td style="text-align:left;"><strong><code>GEOADD</code></strong></td><td style="text-align:left;"><strong>æ·»åŠ </strong>ä¸€ä¸ªæˆ–å¤šä¸ªåœ°ç†ä½ç½®</td><td style="text-align:left;"><code>GEOADD key longitude latitude member [longitude latitude member ...]</code></td><td style="text-align:left;">- ç»åº¦èŒƒå›´ï¼š-180 ï½ +180 - çº¬åº¦èŒƒå›´ï¼š-85.0511 ï½ +85.0511</td><td style="text-align:left;">æˆåŠŸæ·»åŠ çš„æˆå‘˜æ•°é‡ï¼ˆæ•´æ•°ï¼‰</td><td style="text-align:left;">â€¢ åŒå member ä¼šè¦†ç›–æ—§ä½ç½® â€¢ åº•å±‚æ˜¯ <code>ZADD</code></td></tr><tr><td style="text-align:left;"><strong><code>GEOPOS</code></strong></td><td style="text-align:left;"><strong>è·å–</strong>æŒ‡å®šæˆå‘˜çš„ç»çº¬åº¦</td><td style="text-align:left;"><code>GEOPOS key member [member ...]</code></td><td style="text-align:left;">æ”¯æŒæ‰¹é‡æŸ¥è¯¢</td><td style="text-align:left;">æ¯ä¸ªæˆå‘˜å¯¹åº” <code>[longitude, latitude]</code>ï¼Œä¸å­˜åœ¨åˆ™è¿”å› <code>nil</code></td><td style="text-align:left;">è¿”å›é«˜ç²¾åº¦æµ®ç‚¹æ•°</td></tr><tr><td style="text-align:left;"><strong><code>GEODIST</code></strong></td><td style="text-align:left;">è®¡ç®—ä¸¤ä¸ªä½ç½®é—´çš„<strong>è·ç¦»</strong></td><td style="text-align:left;"><code>GEODIST key member1 member2 [unit]</code></td><td style="text-align:left;"><code>unit</code> å¯é€‰ï¼š <code>m</code>ï¼ˆç±³ï¼Œé»˜è®¤ï¼‰ã€<code>km</code>ã€<code>ft</code>ã€<code>mi</code></td><td style="text-align:left;">è·ç¦»æ•°å€¼ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œå•ä½ç”±å‚æ•°å†³å®šï¼›æˆå‘˜ä¸å­˜åœ¨è¿”å› <code>nil</code></td><td style="text-align:left;">åŸºäº Haversine å…¬å¼ï¼ˆçƒé¢è·ç¦»ï¼‰</td></tr><tr><td style="text-align:left;"><strong><code>GEORADIUS</code></strong> ï¼ˆå·²åºŸå¼ƒï¼‰</td><td style="text-align:left;">æ ¹æ®<strong>åæ ‡</strong>æœç´¢é™„è¿‘ä½ç½®</td><td style="text-align:left;">\`GEORADIUS key longitude latitude radius unit [WITHCOORD] [WITHDIST] [WITHHASH] [COUNT n] [ASC</td><td style="text-align:left;">DESC] [STORE key]\`</td><td style="text-align:left;">â€¢ <code>radius</code>ï¼šåŠå¾„ â€¢ <code>unit</code>ï¼šm/km/ft/mi â€¢ <code>WITHxxx</code>ï¼šè¿”å›é™„åŠ ä¿¡æ¯ â€¢ <code>COUNT</code>ï¼šé™åˆ¶ç»“æœæ•°</td><td style="text-align:left;">æˆå‘˜åˆ—è¡¨ï¼ˆå¯å¸¦è·ç¦»ã€åæ ‡ç­‰ï¼‰</td></tr><tr><td style="text-align:left;"><strong><code>GEORADIUSBYMEMBER</code></strong> ï¼ˆå·²åºŸå¼ƒï¼‰</td><td style="text-align:left;">æ ¹æ®<strong>å·²æœ‰æˆå‘˜</strong>æœç´¢é™„è¿‘ä½ç½®</td><td style="text-align:left;"><code>GEORADIUSBYMEMBER key member radius unit [é€‰é¡¹åŒä¸Š]</code></td><td style="text-align:left;">åŒä¸Š</td><td style="text-align:left;">åŒä¸Š</td><td style="text-align:left;">âš ï¸ Redis 6.2+ å·²åºŸå¼ƒ</td></tr><tr><td style="text-align:left;"><strong><code>GEOSEARCH</code></strong> ï¼ˆæ¨è âœ…ï¼‰</td><td style="text-align:left;">ç»Ÿä¸€åœ°ç†æœç´¢å‘½ä»¤ï¼ˆåæ ‡ or æˆå‘˜ï¼‰</td><td style="text-align:left;">\`GEOSEARCH key FROM{LONLAT</td><td style="text-align:left;">MEMBER} ... BY{RADIUS</td><td style="text-align:left;">BOX} ... [WITHDIST] [WITHCOORD] [COUNT n] [ASC</td><td style="text-align:left;">DESC]\`</td></tr><tr><td style="text-align:left;"><strong><code>ZREM</code></strong></td><td style="text-align:left;">åˆ é™¤æŸä¸ªåœ°ç†ä½ç½®</td><td style="text-align:left;"><code>ZREM key member [member ...]</code></td><td style="text-align:left;">â€”</td><td style="text-align:left;">æˆåŠŸåˆ é™¤çš„æ•°é‡</td><td style="text-align:left;">GEO æ— ä¸“ç”¨åˆ é™¤å‘½ä»¤ï¼Œå› åº•å±‚æ˜¯ ZSet</td></tr></tbody></table><hr><blockquote><p><strong>ğŸ”” è¡¥å……è¯´æ˜ï¼š</strong></p><ul><li><strong>åº•å±‚å­˜å‚¨</strong>ï¼šæ‰€æœ‰ GEO æ•°æ®å®é™…å­˜å‚¨åœ¨ <strong>Sorted Set</strong> ä¸­ï¼Œå¯ç”¨ <code>ZRANGE key 0 -1 WITHSCORES</code> æŸ¥çœ‹ GeoHash å€¼ã€‚</li><li><strong>ç²¾åº¦</strong>ï¼šçº¦ <strong>0.5 ç±³</strong>ï¼ˆ52 ä½ GeoHash ç¼–ç ï¼‰ã€‚</li><li><strong>æ€§èƒ½</strong>ï¼šé€‚åˆ <strong>ç™¾ä¸‡çº§ä»¥å†…</strong> çš„å®æ—¶ LBS åœºæ™¯ï¼›è¶…å¤§è§„æ¨¡å»ºè®®ç»“åˆ <strong>Elasticsearch</strong> æˆ–ä¸“ä¸š GISã€‚</li><li><strong>å•ä½æ³¨æ„</strong>ï¼š<code>GEODIST</code> å’Œ <code>GEOSEARCH</code> ä¸­çš„å•ä½å¿…é¡»æ˜¾å¼æŒ‡å®šï¼ˆå¦‚ <code>km</code>ï¼‰ï¼Œå¦åˆ™é»˜è®¤ä¸º <strong>ç±³ï¼ˆmï¼‰</strong>ã€‚</li></ul></blockquote><table><thead><tr><th style="text-align:left;">ç‰¹æ€§</th><th style="text-align:left;">è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>åº•å±‚å®ç°</strong></td><td style="text-align:left;">Sorted Set + GeoHash</td></tr><tr><td style="text-align:left;"><strong>æ ¸å¿ƒèƒ½åŠ›</strong></td><td style="text-align:left;">å­˜å‚¨ä½ç½®ã€ç®—è·ç¦»ã€æœé™„è¿‘</td></tr><tr><td style="text-align:left;"><strong>é€‚ç”¨åœºæ™¯</strong></td><td style="text-align:left;">LBSã€é™„è¿‘æ¨èã€å®æ—¶å®šä½</td></tr><tr><td style="text-align:left;"><strong>æ›¿ä»£æ–¹æ¡ˆ</strong></td><td style="text-align:left;"><strong>å¤§æ•°æ®é‡ç”¨ ES</strong> / PostGISï¼›é«˜å¹¶å‘ç”¨ Redis GEO</td></tr><tr><td style="text-align:left;"><strong>æ³¨æ„</strong></td><td style="text-align:left;">Redis 6.2+ ä¼˜å…ˆç”¨ <code>GEOSEARCH</code></td></tr></tbody></table><blockquote><p>ğŸ’¡ <strong>ä¸€å¥è¯è®°ä½</strong>ï¼š <strong>Redis GEO = ç”¨ Sorted Set å­˜ä½ç½®ï¼Œç”¨ GeoHash å¿«é€Ÿç­›ï¼Œç”¨ Haversine ç²¾ç¡®ç®—ã€‚</strong></p></blockquote><h3 id="é™„ä»¶å•†é“ºæœç´¢" tabindex="-1"><a class="header-anchor" href="#é™„ä»¶å•†é“ºæœç´¢"><span>é™„ä»¶å•†é“ºæœç´¢</span></a></h3><p>æŒ‰ç…§å¦‚ä¸Šç»™å‡ºçš„Redisçš„geoæ•°æ®ç±»å‹æä¾›çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆ<strong>å­˜å‚¨å•†å®¶ç»çº¬åº¦</strong>åˆ°Redisçš„Geo zsetä¸­ï¼Œå†ä½¿ç”¨<strong>geosearch</strong>æœç´¢é™„è¿‘çš„åº—é“ºã€‚</p><p>åŒæ—¶ï¼Œæ¨èå•†åº—ä¸€èˆ¬ä¼šæ¨è<strong>ç±»ä¼¼</strong>çš„å•†åº—ï¼Œæˆ‘ä»¬è¿™é‡Œç®€å•ä½¿ç”¨<strong>æ•°æ®åº“çš„typeå­—æ®µ</strong>å¯¹å•†åº—ç±»å‹åšäº†ä¸€ä¸ªåˆ†ç±»ï¼ˆè€ƒè™‘ä½¿ç”¨Enumsç»´æŠ¤ç±»å‹ä¸ä»£å·æ˜ å°„ï¼‰ï¼Œæ¨èæ—¶å°±æ˜¯ç”¨è¿™ä¸ªç±»å‹æ¥åšåŒç±»æ¨èã€‚è€Œåˆ°Redisä¸­ï¼Œæˆ‘ä»¬é€‰æ‹©å°†æ‰€æœ‰åŒä¸€typeçš„å•†åº—å­˜è‡³åŒä¸€ä¸ªGeo zsetçš„valueä¸­ï¼Œä½¿ç”¨typeæ‹¼æ¥ä¸ºkeyã€‚</p><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre><code><span class="line">    <span class="token annotation punctuation">@Override</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token class-name">Result</span> <span class="token function">queryShopByType</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> typeId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> current<span class="token punctuation">,</span> <span class="token class-name">Double</span> x<span class="token punctuation">,</span> <span class="token class-name">Double</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// åæ ‡å¯èƒ½ä¸ºnullï¼Œç›´æ¥åˆ†é¡µå³å¯</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> y <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token comment">// æ ¹æ®ç±»å‹åˆ†é¡µæŸ¥è¯¢</span></span>
<span class="line">            <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Shop</span><span class="token punctuation">&gt;</span></span> page <span class="token operator">=</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;type_id&quot;</span><span class="token punctuation">,</span> typeId<span class="token punctuation">)</span></span>
<span class="line">                    <span class="token punctuation">.</span><span class="token function">page</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>current<span class="token punctuation">,</span> <span class="token class-name">SystemConstants</span><span class="token punctuation">.</span><span class="token constant">DEFAULT_PAGE_SIZE</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">            <span class="token comment">// è¿”å›æ•°æ®</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>page<span class="token punctuation">.</span><span class="token function">getRecords</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token comment">// æ ¹æ®ç±»å‹åˆ†é¡µæŸ¥è¯¢</span></span>
<span class="line">        <span class="token keyword">int</span> from <span class="token operator">=</span> <span class="token punctuation">(</span>current <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token class-name">SystemConstants</span><span class="token punctuation">.</span><span class="token constant">DEFAULT_PAGE_SIZE</span><span class="token punctuation">;</span>   <span class="token comment">// è®¡ç®—åˆ†é¡µå¼€å§‹ç´¢å¼•</span></span>
<span class="line">        <span class="token keyword">int</span> end <span class="token operator">=</span> current <span class="token operator">*</span> <span class="token class-name">SystemConstants</span><span class="token punctuation">.</span><span class="token constant">DEFAULT_PAGE_SIZE</span><span class="token punctuation">;</span>  <span class="token comment">// è®¡ç®—åˆ†é¡µç»“æŸç´¢å¼•</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// è·å–é™„ä»¶ç›¸ä¼¼ç±»å‹åº—é“ºï¼Œtypeidä¸ºkeyï¼Œè¾“å…¥xyä»¥åŠèŒƒå›´ï¼Œä¸ªæ•°ï¼Œåˆ†é¡µ</span></span>
<span class="line">        <span class="token class-name">String</span> key <span class="token operator">=</span> <span class="token class-name">RedisConstants</span><span class="token punctuation">.</span><span class="token constant">SHOP_GEO_KEY</span> <span class="token operator">+</span> typeId<span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">GeoResults</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">RedisGeoCommands<span class="token punctuation">.</span>GeoLocation</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> search <span class="token operator">=</span> stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForGeo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span></span>
<span class="line">                key<span class="token punctuation">,</span>                                <span class="token comment">// key</span></span>
<span class="line">                <span class="token class-name">GeoReference</span><span class="token punctuation">.</span><span class="token function">fromCoordinate</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">// è¾“å…¥åæ ‡</span></span>
<span class="line">                <span class="token keyword">new</span> <span class="token class-name">Distance</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">,</span>             		<span class="token comment">// èŒƒå›´</span></span>
<span class="line">                <span class="token class-name">RedisGeoCommands<span class="token punctuation">.</span>GeoSearchCommandArgs</span><span class="token punctuation">.</span><span class="token function">newGeoSearchArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">includeDistance</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">                        <span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span>                 <span class="token comment">// æŸ¥è¯¢ä¸ªæ•°ï¼Œfromæ— æ³•æŒ‡å®šï¼Œåªèƒ½ä»0å¼€å§‹è¿”å›ç»“æœï¼Œéœ€è¦è‡ªè¡Œå¤„ç†0~end</span></span>
<span class="line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token comment">// è·å–åº—é“ºid</span></span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>search <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> search<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token comment">// æ²¡æœ‰ç»“æœ</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GeoResult</span><span class="token punctuation">&lt;</span><span class="token class-name">RedisGeoCommands<span class="token punctuation">.</span>GeoLocation</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> content <span class="token operator">=</span> search<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        </span>
<span class="line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>content<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> from<span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment">// åˆ†é¡µåæ²¡æœ‰ç»“æœ</span></span>
<span class="line">            <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line">        <span class="token comment">// å¯¹æ•°æ®åšå¤„ç†</span></span>
<span class="line">        <span class="token comment">// æˆªå–from ~ end</span></span>
<span class="line">        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> ids <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>content<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Distance</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>content<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        content<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                <span class="token function">skip</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span><span class="token punctuation">.</span>                                         <span class="token comment">// è·³è¿‡fromä¸ªæ•°</span></span>
<span class="line">                <span class="token function">forEach</span><span class="token punctuation">(</span>item <span class="token operator">-&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">                    <span class="token class-name">String</span> name <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    ids<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    <span class="token class-name">Distance</span> distance <span class="token operator">=</span> item<span class="token punctuation">.</span><span class="token function">getDistance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> distance<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment">// æ ¹æ®idæŸ¥è¯¢</span></span>
<span class="line"><span class="token comment">//        List&lt;Shop&gt; list = query().in(&quot;id&quot;, ids).last(&quot;ORDER BY FIELD(id,&quot; + ids + &quot;)&quot;).list();</span></span>
<span class="line">        <span class="token class-name">String</span> idsStr <span class="token operator">=</span> <span class="token class-name">StrUtil</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">,</span> ids<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Shop</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Shop</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                <span class="token function">in</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> ids<span class="token punctuation">)</span><span class="token punctuation">.</span></span>
<span class="line">                <span class="token function">last</span><span class="token punctuation">(</span> <span class="token string">&quot;ORDER BY FIELD(id,&quot;</span> <span class="token operator">+</span> idsStr <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Shop</span> shop <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">            shop<span class="token punctuation">.</span><span class="token function">setDistance</span><span class="token punctuation">(</span>map<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>shop<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">        <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">        <span class="token keyword">return</span> <span class="token class-name">Result</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,12)])])}const i=s(p,[["render",o]]),u=JSON.parse('{"path":"/docs/heimadianping/yewusheji/9.fujianshangpu.html","title":"é™„ä»¶å•†é“º","lang":"en-US","frontmatter":{"title":"é™„ä»¶å•†é“º","date":"2025-1-21"},"headers":[{"level":3,"title":"GEOæ•°æ®ç»“æ„","slug":"geoæ•°æ®ç»“æ„","link":"#geoæ•°æ®ç»“æ„","children":[]},{"level":3,"title":"é™„ä»¶å•†é“ºæœç´¢","slug":"é™„ä»¶å•†é“ºæœç´¢","link":"#é™„ä»¶å•†é“ºæœç´¢","children":[]}],"git":{"createdTime":1771155821000,"updatedTime":1771155821000,"contributors":[{"name":"SaltFishGC","email":"130335482+SaltFishGC@users.noreply.github.com","commits":1}]},"filePathRelative":"docs/é»‘é©¬ç‚¹è¯„/ä¸šåŠ¡è®¾è®¡/9.é™„ä»¶å•†é“º.md"}');export{i as comp,u as data};
